import base64
exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBzaHV0aWwKaW1wb3J0IGluc3BlY3QKaW1wb3J0IHN5cwpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBTdHlsZSwgaW5pdAoKaW5pdChhdXRvcmVzZXQ9VHJ1ZSkKCnNtc19iYW5uZXJfbGluZXMgPSBbCiAgICAiICAgX19fX19fICAgICAgX19fXyAgICBfX19fICAgICBfX19fX18gICAgIiwKICAgICIgLicgX19fXyBcXCAgICB8XyAgIFxcICAvICAgX3wgIC4nIF9fX18gXFwgICAiLAogICAgIiB8IChfX18gXFxffCAgICAgfCAgIFxcLyAgIHwgICAgfCAoX19fIFxcX3wgICIsCiAgICAiICBfLl9fX19gLiAgICAgIHwgfFxcICAvfCB8ICAgICBfLl9fX19gLiAgICIsCiAgICAiIHwgXFxfX19fKSB8IF8gIF98IHxfXFwvX3wgfF8gIF98IFxcX19fXykgfCAgIiwKICAgICIgIFxcX19fX19fLicoXyl8X19fX198fF9fX19ffChfKVxcX19fX19fLicgICIKXQoKZGVmIGNsZWFyX3NjcmVlbigpOgogICAgc3VicHJvY2Vzcy5jYWxsKCJjbHMiIGlmIHN1YnByb2Nlc3Mub3MubmFtZSA9PSAibnQiIGVsc2UgImNsZWFyIiwgc2hlbGw9VHJ1ZSkKCmRlZiBhbmltYXRlX2Jhbm5lcigpOgogICAgY2xlYXJfc2NyZWVuKCkKICAgIHRlcm1fd2lkdGggPSBzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoZmFsbGJhY2s9KDgwLCAyMCkpLmNvbHVtbnMKICAgIGZvciBfIGluIHJhbmdlKDUpOgogICAgICAgIHByaW50KCkKICAgIGZvciBsaW5lIGluIHNtc19iYW5uZXJfbGluZXM6CiAgICAgICAgcHJpbnQoRm9yZS5DWUFOICsgU3R5bGUuQlJJR0hUICsgbGluZS5jZW50ZXIodGVybV93aWR0aCkpCiAgICAgICAgdGltZS5zbGVlcCgwLjE1KQogICAgcHJpbnQoIlxuIikKCiMgPT09PT09PT09PT09PT09PT09PT09IEFQSSBGVU5DVElPTlMgPT09PT09PT09PT09PT09PT09PT09CmRlZiBjYWxsX2Fjc19hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2F1dGguYWNzZnV0dXJlc2Nob29sLmNvbS9hcGkvdjEvb3RwL3NlbmQiCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImF1dGguYWNzZnV0dXJlc2Nob29sLmNvbSIsCiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5hY3NmdXR1cmVzY2hvb2wuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5hY3NmdXR1cmVzY2hvb2wuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJwaG9uZSI6IHBob25lX251bWJlcgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYmlrcm95X2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gZiJodHRwczovL2Jpa3JveS5jb20vZGF0YS9waG9uZV9udW1iZXJfbG9naW4vdmVyaWZpY2F0aW9ucy9waG9uZV9sb2dpbj9waG9uZT17cGhvbmVfbnVtYmVyfSIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2Jpa3JveS5jb20vIiwKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2NhbGxfYXBpKG1vYmlsZV9udW1iZXIpOgogICAgdXJsID0gZiJodHRwczovL2NhbGwtYXBpLXZodHgub25yZW5kZXIuY29tL3Ntcy9hcGkvdjE/bnVtPXttb2JpbGVfbnVtYmVyfSIKICAgIHRyeToKICAgICAgICByZXR1cm4gcmVxdWVzdHMuZ2V0KHVybCkuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9ob2ljaG9pX2FwaShtb2JpbGVfbnVtYmVyKToKICAgIHBob25lID0gIis4OCIgKyBtb2JpbGVfbnVtYmVyCiAgICB1cmwgPSAiaHR0cHM6Ly9wcm9kLWFwaS52aWV3bGlmdC5jb20vaWRlbnRpdHkvc2lnbnVwP3NpdGU9aG9pY2hvaXR2JmRldmljZUlkPWJyb3dzZXItMGY5ZDA5NTYtMWY0OS0yNDhmLWYxNmUtMWVhN2Q5OWIxZGE4IgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5ob2ljaG9pLnR2IiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5ob2ljaG9pLnR2LyIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAiLAogICAgICAgICJ4LWFwaS1rZXkiOiAiUEJTb29VZTkxczdSTlJLblhUbVFHN3ozZ3dEMmFEVEE2VGxKcDZlZiIKICAgIH0KICAgIHBheWxvYWQgPSB7CiAgICAgICAgInBob25lTnVtYmVyIjogcGhvbmUsCiAgICAgICAgInJlcXVlc3RUeXBlIjogInNlbmQiLAogICAgICAgICJ3aGF0c2FwcENvbnNlbnQiOiBUcnVlCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYXBleF9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICdodHRwczovL2FwaS5hcGV4NHUuY29tL2FwaS9hdXRoL2xvZ2luJwogICAgaGVhZGVycyA9IHsKICAgICAgICAnYXV0aG9yaXR5JzogJ2FwaS5hcGV4NHUuY29tJywKICAgICAgICAnYWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsCiAgICAgICAgJ2FjY2VwdC1sYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsCiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAnb3JpZ2luJzogJ2h0dHBzOi8vYXBleDR1LmNvbScsCiAgICAgICAgJ3JlZmVyZXInOiAnaHR0cHM6Ly9hcGV4NHUuY29tLycsCiAgICAgICAgJ3NlYy1jaC11YSc6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MScsCiAgICAgICAgJ3NlYy1jaC11YS1wbGF0Zm9ybSc6ICciQW5kcm9pZCInLAogICAgICAgICd1c2VyLWFnZW50JzogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNicsCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICdwaG9uZU51bWJlcic6IHBob25lX251bWJlcgogICAgfQogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJlc3BvbnNlLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIkVycm9yIGR1cmluZyBBUEkgY2FsbDoge2V9IikKICAgICAgICByZXR1cm4gTm9uZQoKZGVmIGNhbGxfZ3BmaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICdodHRwczovL2dwZmktYXBpLmdyYW1lZW5waG9uZS5jb20vYXBpL3YxL2Z3YS9yZXF1ZXN0LWZvci1vdHAnCiAgICBoZWFkZXJzID0gewogICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJywKICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogJ2VuLVVTLGVuO3E9MC45JywKICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCYXNpYyBibVZ0YjJKc2RXVTZRWEJwVlhObGNrQkhVRVpwJywKICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJywKICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly9ncGZpLmdyYW1lZW5waG9uZS5jb20nLAogICAgICAgICdSZWZlcmVyJzogJ2h0dHBzOi8vZ3BmaS5ncmFtZWVucGhvbmUuY29tLycsCiAgICAgICAgJ1NlYy1GZXRjaC1EZXN0JzogJ2VtcHR5JywKICAgICAgICAnU2VjLUZldGNoLU1vZGUnOiAnY29ycycsCiAgICAgICAgJ1NlYy1GZXRjaC1TaXRlJzogJ3NhbWUtc2l0ZScsCiAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKICAgICAgICAnc2VjLWNoLXVhJzogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICdzZWMtY2gtdWEtbW9iaWxlJzogJz8xJywKICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtJzogJyJBbmRyb2lkIicsCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICdwaG9uZSc6IHBob25lX251bWJlciwKICAgICAgICAnZW1haWwnOiAnJywKICAgICAgICAnbGFuZ3VhZ2UnOiAnZW4nCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpCiAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiRXJyb3IgZHVyaW5nIEdQRkkgQVBJIGNhbGw6IHtlfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKCmRlZiBjYWxsX2dob29yaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHBob25lID0gIis4OCIgKyBwaG9uZV9udW1iZXIKICAgIHVybCA9ICJodHRwczovL2FwaS5naG9vcmlsZWFybmluZy5jb20vYXBpL2F1dGgvc2lnbnVwL290cD9fYXBwX3BsYXRmb3JtPXdlYiZfbGFuZz1ibiIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIk9yaWdpbiI6ICJodHRwczovL2dob29yaWxlYXJuaW5nLmNvbSIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9naG9vcmlsZWFybmluZy5jb20vIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIgogICAgfQogICAgZGF0YSA9IHsibW9iaWxlX25vIjogcGhvbmVfbnVtYmVyfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSwgdmVyaWZ5PUZhbHNlKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9lYXN5X2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vY29yZS5lYXN5LmNvbS5iZC9hcGkvdjEvcmVnaXN0cmF0aW9uIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vZWFzeS5jb20uYmQiLAogICAgICAgICJSZWZlcmVyIjogImh0dHBzOi8vZWFzeS5jb20uYmQvIiwKICAgICAgICAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLAogICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJjb3JzIiwKICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiLAogICAgICAgICJkZXZpY2Uta2V5IjogImYzYWE1YWNhZjE3ZGU2NGRiN2Q4MmEwMGM3MzE3OGFmIiwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICJzb2NpYWxfbG9naW5faWQiOiAiIiwKICAgICAgICAibmFtZSI6ICJScnJyIiwKICAgICAgICAiZW1haWwiOiAiZ29vZ2xlQGdtYWlsLmNvbSIsCiAgICAgICAgIm1vYmlsZSI6IHBob25lX251bWJlciwKICAgICAgICAicGFzc3dvcmQiOiAiMTIzNDU2NzgiLAogICAgICAgICJwYXNzd29yZF9jb25maXJtYXRpb24iOiAiMTIzNDU2NzgiLAogICAgICAgICJkZXZpY2Vfa2V5IjogImYzYWE1YWNhZjE3ZGU2NGRiN2Q4MmEwMGM3MzE3OGFmIgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfc3VuZGFyYmFuX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vYXBpLWdhdGV3YXkuc3VuZGFyYmFuY291cmllcmx0ZC5jb20vZ3JhcGhxbCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImF1dGhvcml0eSI6ICJhcGktZ2F0ZXdheS5zdW5kYXJiYW5jb3VyaWVybHRkLmNvbSIsCiAgICAgICAgImFjY2VwdCI6ICIqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJhdXRob3JpemF0aW9uIjogIiIsICAjIExlZnQgYmxhbmsgYXMgaW4gY3VybAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL2N1c3RvbWVyLnN1bmRhcmJhbmNvdXJpZXJsdGQuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL2N1c3RvbWVyLnN1bmRhcmJhbmNvdXJpZXJsdGQuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJvcGVyYXRpb25OYW1lIjogIkNyZWF0ZUFjY2Vzc1Rva2VuIiwKICAgICAgICAidmFyaWFibGVzIjogewogICAgICAgICAgICAiYWNjZXNzVG9rZW5GaWx0ZXIiOiB7CiAgICAgICAgICAgICAgICAidXNlck5hbWUiOiBwaG9uZV9udW1iZXIKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgInF1ZXJ5IjogIiIibXV0YXRpb24gQ3JlYXRlQWNjZXNzVG9rZW4oJGFjY2Vzc1Rva2VuRmlsdGVyOiBBY2Nlc3NUb2tlbklucHV0ISkgewogIGNyZWF0ZUFjY2Vzc1Rva2VuKGFjY2Vzc1Rva2VuRmlsdGVyOiAkYWNjZXNzVG9rZW5GaWx0ZXIpIHsKICAgIG1lc3NhZ2UKICAgIHN0YXR1c0NvZGUKICAgIHJlc3VsdCB7CiAgICAgIHBob25lCiAgICAgIG90cENvdW50ZXIKICAgICAgX190eXBlbmFtZQogICAgfQogICAgX190eXBlbmFtZQogIH0KfSIiIgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfcXVpemdpcmlfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9kZXZlbG9wZXIucXVpemdpcmkueHl6L2FwaS92Mi4wL3NlbmQtb3RwIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogIiovKiIsCiAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgIkNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vYXBwLnF1aXpnaXJpLmNvbS5iZCIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9hcHAucXVpemdpcmkuY29tLmJkLyIsCiAgICAgICAgIlNlYy1GZXRjaC1EZXN0IjogImVtcHR5IiwKICAgICAgICAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsCiAgICAgICAgIlNlYy1GZXRjaC1TaXRlIjogImNyb3NzLXNpdGUiLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgIlgtUmVxdWVzdGVkLVdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAieC1hcGkta2V5IjogImdZc2lOU1ZCRHVDdDh5TVVYcEYwNmlRMWVEck1HdjZHIgogICAgfQoKICAgIHBheWxvYWQgPSB7CiAgICAgICAgInBob25lIjogcGhvbmVfbnVtYmVyLAogICAgICAgICJjb3VudHJ5X2NvZGUiOiAiKzg4IiwKICAgICAgICAiZmNtX3Rva2VuIjogTm9uZQogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9yb21vbmlfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSBmImh0dHBzOi8vcm9tb25pLmNvbS5iZC9hcGkvc2VuZC1vdHA/cGhvbmU9e3Bob25lX251bWJlcn0iCiAgICBoZWFkZXJzID0gewogICAgICAgICJhdXRob3JpdHkiOiAicm9tb25pLmNvbS5iZCIsCiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vcm9tb25pLmNvbS5iZC9zaWdudXAiLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1vcmlnaW4iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgIyBDb29raWUgbm90IHJlcXVpcmVkIHVubGVzcyB5b3Ugd2FudCB0byBzaW11bGF0ZSBhIGxvZ2dlZC1pbiBzZXNzaW9uCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXJzKSAgCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYmR0aWNrZXRzX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vYXBpLmJkdGlja2V0cy5jb206MjAxMDAvdjEvYXV0aCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImF1dGhvcml0eSI6ICJhcGkuYmR0aWNrZXRzLmNvbToyMDEwMCIsCiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL2JkdGlja2V0cy5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vYmR0aWNrZXRzLmNvbS8iLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CgogICAgcGF5bG9hZCA9IHsKICAgICAgICAiY3JlYXRlVXNlckNoZWNrIjogVHJ1ZSwKICAgICAgICAicGhvbmVOdW1iZXIiOiBmIis4OHtwaG9uZV9udW1iZXIubHN0cmlwKCcrJyl9IiwKICAgICAgICAiYXBwbGljYXRpb25DaGFubmVsIjogIldFQl9BUFAiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKSAKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9ncGZpMV9hcGkocGhvbmVfbnVtYmVyPU5vbmUpOgogICAgaWYgcGhvbmVfbnVtYmVyIGlzIE5vbmU6CiAgICAgICAgcGhvbmVfbnVtYmVyID0gaW5wdXQoIkVudGVyIHBob25lIG51bWJlciBmb3IgR1BGSSBBUEk6ICIpLnN0cmlwKCkKCiAgICB1cmwgPSAiaHR0cHM6Ly93ZWJsb2dpbmRhLmdyYW1lZW5waG9uZS5jb20vYmFja2VuZC9hcGkvdjEvb3RwIgoKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vd3d3LmdyYW1lZW5waG9uZS5jb20iLAogICAgICAgICJSZWZlcmVyIjogImh0dHBzOi8vd3d3LmdyYW1lZW5waG9uZS5jb20vIiwKICAgICAgICAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLAogICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJjb3JzIiwKICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJtc2lzZG4iOiBwaG9uZV9udW1iZXIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPXBheWxvYWQpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYXJvZ2dhX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vYXBpLmFyb2dnYS5jb20vYXV0aC92MS9zbXMvc2VuZD9mPW13ZWImYj0mdj0mb3M9Jm9zdj0mcmVmUGFydG5lcj0iCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL20uYXJvZ2dhLmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9tLmFyb2dnYS5jb20vIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CgogICAgZGF0YSA9IHsKICAgICAgICAibW9iaWxlIjogZiIrODh7cGhvbmVfbnVtYmVyfSIsCiAgICAgICAgImZjbVRva2VuIjogIiIsCiAgICAgICAgInJlZmVycmFsIjogIiIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhLCB0aW1lb3V0PTEwKQogICAgICAgIHJldHVybiByZXMuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfbWVkZWFzeV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHBob25lID0gIis4OCIgKyBwaG9uZV9udW1iZXIKICAgIHVybCA9IGYiaHR0cHM6Ly9hcGkubWVkZWFzeS5oZWFsdGgvYXBpL3NlbmQtb3RwL3twaG9uZX0vIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9tZWRlYXN5LmhlYWx0aCIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9tZWRlYXN5LmhlYWx0aC8iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgIlNlYy1GZXRjaC1EZXN0IjogImVtcHR5IiwKICAgICAgICAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsCiAgICAgICAgIlNlYy1GZXRjaC1TaXRlIjogInNhbWUtc2l0ZSIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfb3N1ZHBvdHJvX2FwaShwaG9uZV9udW1iZXIpOgogICAgcGhvbmUgPSAiKzg4LSIgKyBwaG9uZV9udW1iZXIKICAgIHVybCA9ICJodHRwczovL2FwaS5vc3VkcG90cm8uY29tL2FwaS92MS91c2Vycy9zZW5kX290cCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04IiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vb3N1ZHBvdHJvLmNvbSIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9vc3VkcG90cm8uY29tLyIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtc2l0ZSIKICAgIH0KICAgIGRhdGEgPSB7CiAgICAgICAgIm1vYmlsZSI6IHBob25lLAogICAgICAgICJkZXZpY2VUb2tlbiI6ICJ3ZWIiLAogICAgICAgICJsYW5ndWFnZSI6ICJlbiIsCiAgICAgICAgIm9zIjogIndlYiIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWRhdGEpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2Fyb2dnYV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHBob25lID0gIiUyQjg4IiArIHBob25lX251bWJlcgogICAgdXJsID0gImh0dHBzOi8vYXBpLmFyb2dnYS5jb20vYXV0aC92MS9zbXMvc2VuZD9mPW13ZWImYj0mdj0mb3M9Jm9zdj0mcmVmUGFydG5lcj0iCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04IiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vbS5hcm9nZ2EuY29tIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL20uYXJvZ2dhLmNvbS8iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiCiAgICB9CiAgICBkYXRhID0gZiJtb2JpbGU9e3Bob25lfSZmY21Ub2tlbj0mcmVmZXJyYWw9IgoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfbWVkZWFzeV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHBob25lID0gIis4OCIgKyBwaG9uZV9udW1iZXIKICAgIHVybCA9IGYiaHR0cHM6Ly9hcGkubWVkZWFzeS5oZWFsdGgvYXBpL3NlbmQtb3RwL3twaG9uZX0vIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJBY2NlcHQtTGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJDb25uZWN0aW9uIjogImtlZXAtYWxpdmUiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9tZWRlYXN5LmhlYWx0aCIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9tZWRlYXN5LmhlYWx0aC8iLAogICAgICAgICJTZWMtRmV0Y2gtRGVzdCI6ICJlbXB0eSIsCiAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLAogICAgICAgICJTZWMtRmV0Y2gtU2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF91bGFfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9lcG9ydGFsLnVsYS5jb20uYmQvYXBpL3NlbmQtb3RwLXRvLXBob25lIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vd3d3LnVsYS5jb20uYmQiLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vd3d3LnVsYS5jb20uYmQvIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtc2l0ZSIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAicGhvbmVfbnVtYmVyIjogIis4OCIgKyBwaG9uZV9udW1iZXIsCiAgICAgICAgImZyb20iOiAiY3VzdG9tZXIiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1kYXRhKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9sYXp6cGhhcm1hX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vd3d3LmxhenpwaGFybWEuY29tL01lc3NhZ2luZ0FyZWEvT3RwTWVzc2FnZS9XZWJSZWdpc3RlciIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICIqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJhY2Nlc3MtY29udHJvbC1hbGxvdy1vcmlnaW4iOiAiKiIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vd3d3LmxhenpwaGFybWEuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5sYXp6cGhhcm1hLmNvbS8iLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1vcmlnaW4iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KICAgIGRhdGEgPSB7CiAgICAgICAgIkFjdGl2aXR5SWQiOiAiMTgzNGI4OTctNDg4NC00NjMwLWE5MDktYjFmMDU0YWMxMGVkIiwKICAgICAgICAiUGhvbmUiOiAiKzg4IiArIHBob25lX251bWJlcgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfcm9rb21hcmlfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSBmImh0dHBzOi8vd3d3LnJva29tYXJpLmNvbS9vdHAvc2VuZD9lbWFpbE9yUGhvbmU9ODh7cGhvbmVfbnVtYmVyfSZjb3VudHJ5Q29kZT1CRCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICIqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LWxlbmd0aCI6ICIwIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vd3d3LnJva29tYXJpLmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly93d3cucm9rb21hcmkuY29tL2xvZ2luIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtb3JpZ2luIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiLAogICAgICAgICJ4LXJlcXVlc3RlZC13aXRoIjogIlhNTEh0dHBSZXF1ZXN0IgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3NtYXJ0cG9zdGJkX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gJ2h0dHBzOi8vYXBpLnNtYXJ0cG9zdGJkLmNvbS9vbmxpbmUtYm9va2luZy9hcGkvcmVnaXN0ZXItb3RwJwogICAgaGVhZGVycyA9IHsKICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsCiAgICAgICAgJ0FjY2VwdC1MYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsCiAgICAgICAgJ0Nvbm5lY3Rpb24nOiAna2VlcC1hbGl2ZScsCiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhOyBib3VuZGFyeT0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5c0dncTUyYnB0SGdLdDVTZScsCiAgICAgICAgJ09yaWdpbic6ICdodHRwczovL29ubGluZS5icG9kbXMuZ292LmJkJywKICAgICAgICAnUmVmZXJlcic6ICdodHRwczovL29ubGluZS5icG9kbXMuZ292LmJkLycsCiAgICAgICAgJ1NlYy1GZXRjaC1EZXN0JzogJ2VtcHR5JywKICAgICAgICAnU2VjLUZldGNoLU1vZGUnOiAnY29ycycsCiAgICAgICAgJ1NlYy1GZXRjaC1TaXRlJzogJ2Nyb3NzLXNpdGUnLAogICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNicsCiAgICAgICAgJ3NlYy1jaC11YSc6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MScsCiAgICAgICAgJ3NlYy1jaC11YS1wbGF0Zm9ybSc6ICciQW5kcm9pZCInLAogICAgfQogICAgZGF0YSA9ICgKICAgICAgICAnLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5c0dncTUyYnB0SGdLdDVTZVxyXG4nCiAgICAgICAgJ0NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0icGhvbmUiXHJcblxyXG4nCiAgICAgICAgZid7cGhvbmVfbnVtYmVyfVxyXG4nCiAgICAgICAgJy0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeXNHZ3E1MmJwdEhnS3Q1U2VcclxuJwogICAgICAgICdDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InBhc3N3b3JkIlxyXG5cclxuJwogICAgICAgICdBMTIzNDU2NzhhXHJcbicKICAgICAgICAnLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5c0dncTUyYnB0SGdLdDVTZVxyXG4nCiAgICAgICAgJ0NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0icmVwYXNzd29yZCJcclxuXHJcbicKICAgICAgICAnQTEyMzQ1Njc4YVxyXG4nCiAgICAgICAgJy0tLS0tLVdlYktpdEZvcm1Cb3VuZGFyeXNHZ3E1MmJwdEhnS3Q1U2UtLVxyXG4nCiAgICApCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWRhdGEsIHZlcmlmeT1GYWxzZSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfZGlnaWhhYXRfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuZGlnaWhhYXQuY29tLmJkL2FwaS9vdHAvZ2VuZXJhdGUtb3RwIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSxibi1CRDtxPTAuOCxibjtxPTAuNyIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vZGlnaWhhYXQuY29tLmJkIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2RpZ2loYWF0LmNvbS5iZC8iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICB9CiAgICBkYXRhID0geyJwaG9uZU5vIjogcGhvbmVfbnVtYmVyfQogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1kYXRhKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDEKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF93YWx0b25wbGF6YV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL3dhbHRvbnBsYXphLmNvbS5iZC9hcGkvYXV0aC9vdHAvY3JlYXRlIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSxibi1CRDtxPTAuOCxibjtxPTAuNyIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vd2FsdG9ucGxhemEuY29tLmJkIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3dhbHRvbnBsYXphLmNvbS5iZC9hdXRoL3Bob25lLWxvZ2luIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CgogICAgZGF0YSA9IHsKICAgICAgICAiYXV0aCI6IHsKICAgICAgICAgICAgImNvdW50cnlDb2RlIjogIjg4MCIsCiAgICAgICAgICAgICJkZXZpY2VVdWlkIjogIjdmNTQ2NDgwLTMyZDctMTFmMC04YmE5LTI3ZDkwY2E3YmQ0OCIsCiAgICAgICAgICAgICJwaG9uZSI6IHBob25lX251bWJlci5sc3RyaXAoIis4OCIpLAogICAgICAgICAgICAidHlwZSI6ICJMT0dJTiIKICAgICAgICB9LAogICAgICAgICJjYXB0Y2hhVG9rZW4iOiAibm8gcmVjYXBjaGEiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3Nod2Fwbm9fYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly93d3cuc2h3YXBuby5jb20vYXBpL2F1dGgiCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiKi8qIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly93d3cuc2h3YXBuby5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vd3d3LnNod2Fwbm8uY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQoKICAgIGRhdGEgPSB7CiAgICAgICAgInBob25lTnVtYmVyIjogcGhvbmVfbnVtYmVyICAjIGZ1bGwgbnVtYmVyIG11c3QgYmUgcGFzc2VkIGNvcnJlY3RseQogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWRhdGEsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9zaGlraG9fYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuc2hpa2hvLmNvbS9hdXRoL3YyL3NlbmQvc21zIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSxibi1CRDtxPTAuOCxibjtxPTAuNyIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vc2hvcC5zaGlraG8uY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3Nob3Auc2hpa2hvLmNvbS8iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBkYXRhID0gewogICAgICAgICJwaG9uZSI6IHBob25lX251bWJlciwgICMgbXVzdCBpbmNsdWRlIDg4MCBwcmVmaXggaWYgbmVlZGVkCiAgICAgICAgInR5cGUiOiAic3R1ZGVudCIsCiAgICAgICAgImF1dGhfdHlwZSI6ICJzaWdudXAiLAogICAgICAgICJ2ZW5kb3IiOiAic2hpa2hvIgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBqc29uPWRhdGEsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCiMgPT09PT09PT09PT09PT09PT09PT09IEFQSSBIQU5ETEVSID09PT09PT09PT09PT09PT09PT09PQpkZWYgaGFuZGxlX2FwaXMobW9iaWxlX251bWJlcik6CiAgICBjdXJyZW50X21vZHVsZSA9IHN5cy5tb2R1bGVzW19fbmFtZV9fXQogICAgYXBpX2Z1bmN0aW9ucyA9IFsKICAgICAgICAobmFtZSwgZnVuYykgZm9yIG5hbWUsIGZ1bmMgaW4gaW5zcGVjdC5nZXRtZW1iZXJzKGN1cnJlbnRfbW9kdWxlLCBpbnNwZWN0LmlzZnVuY3Rpb24pCiAgICAgICAgaWYgbmFtZS5zdGFydHN3aXRoKCJjYWxsXyIpIGFuZCBuYW1lLmVuZHN3aXRoKCJfYXBpIikKICAgIF0KCiAgICBzdWNjZXNzX2FwaXMgPSBbXQogICAgZmFpbGVkX2FwaXMgPSBbXQoKICAgIGZvciBuYW1lLCBhcGlfZnVuYyBpbiBhcGlfZnVuY3Rpb25zOgogICAgICAgIHRyeToKICAgICAgICAgICAgaWYgYXBpX2Z1bmMobW9iaWxlX251bWJlcik6CiAgICAgICAgICAgICAgICBzdWNjZXNzX2FwaXMuYXBwZW5kKG5hbWUpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmYWlsZWRfYXBpcy5hcHBlbmQobmFtZSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBmYWlsZWRfYXBpcy5hcHBlbmQobmFtZSkKCiAgICByZXR1cm4gc3VjY2Vzc19hcGlzLCBmYWlsZWRfYXBpcwoKIyA9PT09PT09PT09PT09PT09PT09PT0gTUFJTiA9PT09PT09PT09PT09PT09PT09PT0KZGVmIG1haW4oKToKICAgIGFuaW1hdGVfYmFubmVyKCkKICAgIHByaW50KEZvcmUuQ1lBTiArIFN0eWxlLkJSSUdIVCArICJcbldlbGNvbWUgdG8gdGhlIFNNUyDwn5KlQm9vbWVy8J+SpSBUb29sIVxuIikKICAgIG1vYmlsZV9udW1iZXIgPSBpbnB1dChGb3JlLlJFRCArIFN0eWxlLkJSSUdIVCArICJFbnRlciB0aGUgbW9iaWxlIG51bWJlciAoRXguIDAxNzM0NTY3ODkwKTogIikuc3RyaXAoKQoKICAgIHByaW50KCkKCiAgICBpZiBub3QgKG1vYmlsZV9udW1iZXIuc3RhcnRzd2l0aCgiMDEiKSBhbmQgbGVuKG1vYmlsZV9udW1iZXIpID09IDExKToKICAgICAgICBwcmludChGb3JlLlJFRCArICJJbnZhbGlkIG51bWJlci4gTXVzdCBzdGFydCB3aXRoIDAxIGFuZCBiZSAxMSBkaWdpdHMuIikKICAgICAgICByZXR1cm4KCiAgICB0cnk6CiAgICAgICAgbWVzc2FnZV9nb2FsID0gaW50KGlucHV0KEZvcmUuWUVMTE9XICsgU3R5bGUuQlJJR0hUICsgIkhvdyBtYW55IG1lc3NhZ2VzIGRvIHlvdSB3YW50IHRvIHNlbmQ/ICA6ICIpKQogICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiUGxlYXNlIGVudGVyIGEgdmFsaWQgbnVtYmVyLiIpCiAgICAgICAgcmV0dXJuCgogICAgY3VycmVudF9tb2R1bGUgPSBzeXMubW9kdWxlc1tfX25hbWVfX10KICAgIGFwaV9mdW5jdGlvbnMgPSBbCiAgICAgICAgZnVuYyBmb3IgbmFtZSwgZnVuYyBpbiBpbnNwZWN0LmdldG1lbWJlcnMoY3VycmVudF9tb2R1bGUsIGluc3BlY3QuaXNmdW5jdGlvbikKICAgICAgICBpZiBuYW1lLnN0YXJ0c3dpdGgoImNhbGxfIikgYW5kIG5hbWUuZW5kc3dpdGgoIl9hcGkiKQogICAgXQoKICAgIG1heF9hdmFpbGFibGUgPSBsZW4oYXBpX2Z1bmN0aW9ucykKICAgIHByaW50KEZvcmUuTUFHRU5UQSArICJcblNlbmRpbmcgU01TLi4uXG4iLmNlbnRlcihzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoKS5jb2x1bW5zKSkKCiAgICB0b3RhbF9zdWNjZXNzID0gW10KICAgIHRvdGFsX2ZhaWxlZCA9IFtdCiAgICBzZW50X2NvdW50ID0gMCAgIyBDb3VudCBzdWNjZXNzZnVsIHNlbmRzCgogICAgaWYgbWVzc2FnZV9nb2FsID49IG1heF9hdmFpbGFibGU6CiAgICAgICAgZm9yIGFwaV9mdW5jIGluIGFwaV9mdW5jdGlvbnM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGFwaV9mdW5jKG1vYmlsZV9udW1iZXIpOgogICAgICAgICAgICAgICAgICAgIHRvdGFsX3N1Y2Nlc3MuYXBwZW5kKGFwaV9mdW5jLl9fbmFtZV9fKQogICAgICAgICAgICAgICAgICAgIHNlbnRfY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgIHRlcm1fd2lkdGggPSBzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoKS5jb2x1bW5zCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIFN0eWxlLkJSSUdIVCArIGYiXHJ7J1NNUyBzZW50ID0gJyArIHN0cihzZW50X2NvdW50KTpee3Rlcm1fd2lkdGh9fSIsIGVuZD0nJywgZmx1c2g9VHJ1ZSkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgdG90YWxfZmFpbGVkLmFwcGVuZChhcGlfZnVuYy5fX25hbWVfXykKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4zKSAgIyBkZWxheQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICAgICAgdG90YWxfZmFpbGVkLmFwcGVuZChhcGlfZnVuYy5fX25hbWVfXykKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4zKQogICAgZWxzZToKICAgICAgICBzdWNjZXNzX2NvdW50ID0gMAogICAgICAgIHdoaWxlIHN1Y2Nlc3NfY291bnQgPCBtZXNzYWdlX2dvYWw6CiAgICAgICAgICAgIGZvciBhcGlfZnVuYyBpbiBhcGlfZnVuY3Rpb25zOgogICAgICAgICAgICAgICAgaWYgc3VjY2Vzc19jb3VudCA+PSBtZXNzYWdlX2dvYWw6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBpZiBhcGlfZnVuYyhtb2JpbGVfbnVtYmVyKToKICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxfc3VjY2Vzcy5hcHBlbmQoYXBpX2Z1bmMuX19uYW1lX18pCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NfY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICBzZW50X2NvdW50ICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgdGVybV93aWR0aCA9IHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSgpLmNvbHVtbnMKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIFN0eWxlLkJSSUdIVCArIGYiXHJ7J1NNUyBzZW50ID0gJyArIHN0cihzZW50X2NvdW50KTpee3Rlcm1fd2lkdGh9fSIsIGVuZD0nJywgZmx1c2g9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbF9mYWlsZWQuYXBwZW5kKGFwaV9mdW5jLl9fbmFtZV9fKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4zKQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgICAgICAgICB0b3RhbF9mYWlsZWQuYXBwZW5kKGFwaV9mdW5jLl9fbmFtZV9fKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4zKQoKICAgIHByaW50KCJcbiIpCiAgICBwcmludChGb3JlLkNZQU4gKyAiXG5TdW1tYXJ5OlxuIi5jZW50ZXIoc2h1dGlsLmdldF90ZXJtaW5hbF9zaXplKCkuY29sdW1ucykpCiAgICBwcmludChGb3JlLkdSRUVOICsgZiLinJQgVG90YWwgU3VjY2Vzc2Z1bDoge2xlbih0b3RhbF9zdWNjZXNzKX0iLmNlbnRlcihzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoKS5jb2x1bW5zKSkKICAgIHByaW50KEZvcmUuUkVEICsgZiJcbuKcmCBUb3RhbCBGYWlsZWQgQXR0ZW1wdHM6IHtsZW4odG90YWxfZmFpbGVkKX0iLmNlbnRlcihzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoKS5jb2x1bW5zKSkKICAgIGlmIHRvdGFsX2ZhaWxlZDoKICAgICAgICBmb3IgYXBpIGluIHRvdGFsX2ZhaWxlZDoKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyBmIiAg4oaSIHthcGl9IikKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp'))