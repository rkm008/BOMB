import base64
exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBzaHV0aWwKaW1wb3J0IGluc3BlY3QKaW1wb3J0IGpzb24KaW1wb3J0IHN5cwpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBTdHlsZSwgaW5pdApmcm9tIGZha2VfdXNlcmFnZW50IGltcG9ydCBVc2VyQWdlbnQKdWEgPSBVc2VyQWdlbnQoKQoKaW5pdChhdXRvcmVzZXQ9VHJ1ZSkKCnNtc19iYW5uZXJfbGluZXMgPSBbCiAgICAiICAgX19fX19fICAgICAgX19fXyAgICBfX19fICAgICBfX19fX18gICAgIiwKICAgICIgLicgX19fXyBcXCAgICB8XyAgIFxcICAvICAgX3wgIC4nIF9fX18gXFwgICAiLAogICAgIiB8IChfX18gXFxffCAgICAgfCAgIFxcLyAgIHwgICAgfCAoX19fIFxcX3wgICIsCiAgICAiICBfLl9fX19gLiAgICAgIHwgfFxcICAvfCB8ICAgICBfLl9fX19gLiAgICIsCiAgICAiIHwgXFxfX19fKSB8IF8gIF98IHxfXFwvX3wgfF8gIF98IFxcX19fXykgfCAgIiwKICAgICIgIFxcX19fX19fLicoXyl8X19fX198fF9fX19ffChfKVxcX19fX19fLicgICIKXQoKZGVmIGNsZWFyX3NjcmVlbigpOgogICAgc3VicHJvY2Vzcy5jYWxsKCJjbHMiIGlmIHN1YnByb2Nlc3Mub3MubmFtZSA9PSAibnQiIGVsc2UgImNsZWFyIiwgc2hlbGw9VHJ1ZSkKCmRlZiBhbmltYXRlX2Jhbm5lcigpOgogICAgY2xlYXJfc2NyZWVuKCkKICAgIHRlcm1fd2lkdGggPSBzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoZmFsbGJhY2s9KDgwLCAyMCkpLmNvbHVtbnMKICAgIGZvciBfIGluIHJhbmdlKDUpOgogICAgICAgIHByaW50KCkKICAgIGZvciBsaW5lIGluIHNtc19iYW5uZXJfbGluZXM6CiAgICAgICAgcHJpbnQoRm9yZS5DWUFOICsgU3R5bGUuQlJJR0hUICsgbGluZS5jZW50ZXIodGVybV93aWR0aCkpCiAgICAgICAgdGltZS5zbGVlcCgwLjE1KQogICAgcHJpbnQoIlxuIikKCiMgPT09PT09PT09PT09PT09PT09PT09IEFQSSBGVU5DVElPTlMgPT09PT09PT09PT09PT09PT09PT09CmRlZiBjYWxsX2Nob3JraV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS1keW5hbWljLmNob3JraS5jb20vdjIvYXV0aC9sb2dpbj9jb3VudHJ5PUJEJnBsYXRmb3JtPXdlYiZsYW5ndWFnZT1lbiIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiYXV0aG9yaXphdGlvbiI6ICIiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5jaG9ya2kuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5jaG9ya2kuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICJBbmRyb2lkIiwKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAidXNlci1hZ2VudCI6IHVhLnJhbmRvbQogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAibnVtYmVyIjogIis4OCIgKyBwaG9uZV9udW1iZXJbLTEwOl0KICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWRhdGEpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3JlZHhfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkucmVkeC5jb20uYmQvdjEvbWVyY2hhbnQvcmVnaXN0cmF0aW9uL2dlbmVyYXRlLXJlZ2lzdHJhdGlvbi1vdHAiCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly9yZWR4LmNvbS5iZCIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9yZWR4LmNvbS5iZC8iLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAidXNlci1hZ2VudCI6IHVhLnJhbmRvbQogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAicGhvbmVOdW1iZXIiOiAiMCIgKyBwaG9uZV9udW1iZXJbLTEwOl0gICMgZW5zdXJlcyAwMVhYWFhYWFhYWCBmb3JtYXQKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWRhdGEpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3phdGlxX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vZWFzeWJpbGwuemF0aXEudGVjaC9hcGkvYXV0aC92MS9zZW5kX290cCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgImFwcGxpY2F0aW9uLXR5cGUiOiAiTWVyY2hhbnQiLAogICAgICAgICJkZXZpY2UtdHlwZSI6ICJXZWIiLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly9tZXJjaGFudC56YXRpcWVhc3kuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL21lcmNoYW50LnphdGlxZWFzeS5jb20vIiwKICAgICAgICAidXNlci1hZ2VudCI6IHVhLnJhbmRvbQogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAiY29kZSI6ICIrODgwIiwKICAgICAgICAiY291bnRyeV9jb2RlIjogIkJEIiwKICAgICAgICAicGhvbmUiOiAiMCIgKyBwaG9uZV9udW1iZXJbLTEwOl0sICAjIEVuc3VyZSBmb3JtYXQgbGlrZSAwMTN4eHh4eHh4CiAgICAgICAgImlzX2V4aXN0aW5nX3VzZXIiOiBGYWxzZQogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYmluZ2VfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSBmImh0dHBzOi8vd2ViLWFwaS5iaW5nZS5idXp6L2FwaS92My9vdHAvc2VuZC8rODh7cGhvbmVfbnVtYmVyWy0xMDpdfSIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJBdXRob3JpemF0aW9uIjogIkJlYXJlciBleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuZXlKemRHRjBkWE1pT2lKR2NtVmxJaXdpWTNKbFlYUmxaRUYwSWpvaVkzSmxZWFJsSUdSaGRHVWlMQ0oxY0dSaGRHVmtRWFFpT2lKMWNHUmhkR1VnWkdGMFpTSXNJblI1Y0dVaU9pSjBiMnRsYmlJc0ltUmxkbFI1Y0dVaU9pSjNaV0lpTENKbGVIUnlZU0k2SWpNeE5ERTFPVEkySWl3aWFXRjBJam94TnpRNE1qWTFPRGczTENKbGVIQWlPakUzTkRnME16ZzJPRGQ5LkluaUNTYWo0RFRMRFZyZkJlcjFhMWNYeHpiaGtqdWt0MFdIME1ROS1FaXMiLAogICAgICAgICJEZXZpY2UtVHlwZSI6ICJ3ZWIiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9iaW5nZS5idXp6IiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2JpbmdlLmJ1enovIiwKICAgICAgICAiVXNlci1BZ2VudCI6IHVhLnJhbmRvbQogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfZGVlcHRvcGxheV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS5kZWVwdG9wbGF5LmNvbS92Mi9hdXRoL2xvZ2luP2NvdW50cnk9QkQmcGxhdGZvcm09d2ViJmxhbmd1YWdlPWVuIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5kZWVwdG9wbGF5LmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuZGVlcHRvcGxheS5jb20vIiwKICAgICAgICAidXNlci1hZ2VudCI6IHVhLnJhbmRvbQogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAibnVtYmVyIjogIis4OCIgKyBwaG9uZV9udW1iZXJbLTEwOl0gICMgRW5zdXJlIGNvcnJlY3QgQmFuZ2xhZGVzaGkgZm9ybWF0CiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1kYXRhKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9mdW5kZXNoX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vZnVuZGVzaC5jb20uYmQvYXBpL2F1dGgvZ2VuZXJhdGVPVFA/c2VydmljZV9rZXk9IgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PVVURi04IiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vZnVuZGVzaC5jb20uYmQiLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vZnVuZGVzaC5jb20uYmQvZnVuZGVzaC9wcm9maWxlIiwKICAgICAgICAidXNlci1hZ2VudCI6IHVhLnJhbmRvbQogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAibXNpc2RuIjogcGhvbmVfbnVtYmVyWy0xMDpdICAjIFJlbW92ZSArODggYW5kIHVzZSBmb3JtYXQgbGlrZSAxMzF4eHh4eHh4CiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1kYXRhKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9iaW9zY29wZV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS1keW5hbWljLmJpb3Njb3BlbGl2ZS5jb20vdjIvYXV0aC9sb2dpbj9jb3VudHJ5PUJEJnBsYXRmb3JtPXdlYiZsYW5ndWFnZT1lbiIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiYXV0aG9yaXphdGlvbiI6ICIiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5iaW9zY29wZWxpdmUuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5iaW9zY29wZWxpdmUuY29tLyIsCiAgICAgICAgInVzZXItYWdlbnQiOiB1YS5yYW5kb20KICAgIH0KICAgIGRhdGEgPSB7CiAgICAgICAgInBob25lIjogIis4OCIgKyBwaG9uZV9udW1iZXJbLTExOl0gICMgRW5zdXJlIG51bWJlciBmb3JtYXQgbGlrZSAwMTN4eHh4eHh4eAogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfY2xhc3Nyb29tYmRfYXBpKHBob25lX251bWJlcik6CiAgICBpbXBvcnQgcmVxdWVzdHMKICAgIGltcG9ydCByZQoKICAgIHNlc3Npb24gPSByZXF1ZXN0cy5TZXNzaW9uKCkKICAgIHRyeToKICAgICAgICAjIFN0ZXAgMTogR2V0IHRoZSByZWdpc3RyYXRpb24gcGFnZSB0byByZXRyaWV2ZSBDU1JGIHRva2VuCiAgICAgICAgcmVzID0gc2Vzc2lvbi5nZXQoImh0dHBzOi8vY2xhc3Nyb29tYmFuZ2xhZGVzaC5jb20vcmVnaXN0ZXIiKQogICAgICAgIGNzcmZfdG9rZW5fbWF0Y2ggPSByZS5zZWFyY2gocic8bWV0YSBuYW1lPSJjc3JmLXRva2VuIiBjb250ZW50PSIoLis/KSInLCByZXMudGV4dCkKICAgICAgICBpZiBub3QgY3NyZl90b2tlbl9tYXRjaDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgY3NyZl90b2tlbiA9IGNzcmZfdG9rZW5fbWF0Y2guZ3JvdXAoMSkKCiAgICAgICAgIyBTdGVwIDI6IFByZXBhcmUgaGVhZGVycyBhbmQgc2VuZCBPVFAgcmVxdWVzdAogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICJhY2NlcHQiOiAiKi8qIiwKICAgICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLAogICAgICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vY2xhc3Nyb29tYmFuZ2xhZGVzaC5jb20iLAogICAgICAgICAgICAicmVmZXJlciI6ICJodHRwczovL2NsYXNzcm9vbWJhbmdsYWRlc2guY29tL3JlZ2lzdGVyIiwKICAgICAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAgICAgIngtY3NyZi10b2tlbiI6IGNzcmZfdG9rZW4sCiAgICAgICAgICAgICJ4LXJlcXVlc3RlZC13aXRoIjogIlhNTEh0dHBSZXF1ZXN0IgogICAgICAgIH0KICAgICAgICBkYXRhID0gZiJwaG9uZT17cGhvbmVfbnVtYmVyfSIKCiAgICAgICAgcmVzcG9uc2UgPSBzZXNzaW9uLnBvc3QoImh0dHBzOi8vY2xhc3Nyb29tYmFuZ2xhZGVzaC5jb20vc2VuZC1vdHAiLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYm9odWJyaWhpX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vYmItYXBpLmJvaHVicmloaS5jb20vcHVibGljL2FjdGl2aXR5L290cCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJhdXRob3JpemF0aW9uIjogIkJlYXJlciB1bmRlZmluZWQiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL2JvaHVicmloaS5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vYm9odWJyaWhpLmNvbS8iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KICAgIGRhdGEgPSB7CiAgICAgICAgInBob25lIjogIjAiICsgcGhvbmVfbnVtYmVyWy0xMDpdLCAgIyBFbnN1cmUgbnVtYmVyIGZvcm1hdCBsaWtlIDAxM3h4eHh4eHgKICAgICAgICAiaW50ZW50IjogImxvZ2luIgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfcGF0aGFvX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vd2ViYXV0aC5wYXRoYW8uY29tL2F1dGgvZ2V0LW90cCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjksYm4tQkQ7cT0wLjgsYm47cT0wLjciLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL2Zvb2QucGF0aGFvLmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9mb29kLnBhdGhhby5jb20vIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CgogICAgZGF0YSA9IHsKICAgICAgICAiY291bnRyeV9wcmVmaXgiOiAiODgwIiwKICAgICAgICAibmF0aW9uYWxfbnVtYmVyIjogcGhvbmVfbnVtYmVyLmxzdHJpcCgiKzg4MCIpLAogICAgICAgICJjb3VudHJ5X2lkIjogMSwKICAgICAgICAiY2xpZW50X2lkIjogIjI2ODcwOTUyMzEiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2Fjc19hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2F1dGguYWNzZnV0dXJlc2Nob29sLmNvbS9hcGkvdjEvb3RwL3NlbmQiCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImF1dGguYWNzZnV0dXJlc2Nob29sLmNvbSIsCiAgICAgICAgImFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5hY3NmdXR1cmVzY2hvb2wuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5hY3NmdXR1cmVzY2hvb2wuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJwaG9uZSI6IHBob25lX251bWJlcgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYmlrcm95X2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gZiJodHRwczovL2Jpa3JveS5jb20vZGF0YS9waG9uZV9udW1iZXJfbG9naW4vdmVyaWZpY2F0aW9ucy9waG9uZV9sb2dpbj9waG9uZT17cGhvbmVfbnVtYmVyLmxzdHJpcCgnKzg4Jyl9IgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJibiIsCiAgICAgICAgImFwcGxpY2F0aW9uLW5hbWUiOiAid2ViIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL2Jpa3JveS5jb20vYm4vdXNlcnMvbG9naW4/YWN0aW9uPW15LWFjY291bnQmcmVkaXJlY3QtdXJsPSUyRmJuJTJGbXklMkZkYXNoYm9hcmQiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfY2FsbF9hcGkobW9iaWxlX251bWJlcik6CiAgICB1cmwgPSBmImh0dHBzOi8vY2FsbC1hcGktdmh0eC5vbnJlbmRlci5jb20vc21zL2FwaS92MT9udW09e21vYmlsZV9udW1iZXJ9IgogICAgdHJ5OgogICAgICAgIHJldHVybiByZXF1ZXN0cy5nZXQodXJsKS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2hvaWNob2lfYXBpKG1vYmlsZV9udW1iZXIpOgogICAgcGhvbmUgPSAiKzg4IiArIG1vYmlsZV9udW1iZXIKICAgIHVybCA9ICJodHRwczovL3Byb2QtYXBpLnZpZXdsaWZ0LmNvbS9pZGVudGl0eS9zaWdudXA/c2l0ZT1ob2ljaG9pdHYmZGV2aWNlSWQ9YnJvd3Nlci0wZjlkMDk1Ni0xZjQ5LTI0OGYtZjE2ZS0xZWE3ZDk5YjFkYTgiCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vd3d3LmhvaWNob2kudHYiLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vd3d3LmhvaWNob2kudHYvIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCIsCiAgICAgICAgIngtYXBpLWtleSI6ICJQQlNvb1VlOTFzN1JOUktuWFRtUUc3ejNnd0QyYURUQTZUbEpwNmVmIgogICAgfQogICAgcGF5bG9hZCA9IHsKICAgICAgICAicGhvbmVOdW1iZXIiOiBwaG9uZSwKICAgICAgICAicmVxdWVzdFR5cGUiOiAic2VuZCIsCiAgICAgICAgIndoYXRzYXBwQ29uc2VudCI6IFRydWUKICAgIH0KICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9hcGV4X2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gJ2h0dHBzOi8vYXBpLmFwZXg0dS5jb20vYXBpL2F1dGgvbG9naW4nCiAgICBoZWFkZXJzID0gewogICAgICAgICdhdXRob3JpdHknOiAnYXBpLmFwZXg0dS5jb20nLAogICAgICAgICdhY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJywKICAgICAgICAnYWNjZXB0LWxhbmd1YWdlJzogJ2VuLVVTLGVuO3E9MC45JywKICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICdvcmlnaW4nOiAnaHR0cHM6Ly9hcGV4NHUuY29tJywKICAgICAgICAncmVmZXJlcic6ICdodHRwczovL2FwZXg0dS5jb20vJywKICAgICAgICAnc2VjLWNoLXVhJzogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICdzZWMtY2gtdWEtbW9iaWxlJzogJz8xJywKICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtJzogJyJBbmRyb2lkIicsCiAgICAgICAgJ3VzZXItYWdlbnQnOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKICAgIH0KICAgIHBheWxvYWQgPSB7CiAgICAgICAgJ3Bob25lTnVtYmVyJzogcGhvbmVfbnVtYmVyCiAgICB9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpCiAgICAgICAgcmVzcG9uc2UucmFpc2VfZm9yX3N0YXR1cygpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiRXJyb3IgZHVyaW5nIEFQSSBjYWxsOiB7ZX0iKQogICAgICAgIHJldHVybiBOb25lCgpkZWYgY2FsbF9ncGZpX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gJ2h0dHBzOi8vZ3BmaS1hcGkuZ3JhbWVlbnBob25lLmNvbS9hcGkvdjEvZndhL3JlcXVlc3QtZm9yLW90cCcKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L3BsYWluLCAqLyonLAogICAgICAgICdBY2NlcHQtTGFuZ3VhZ2UnOiAnZW4tVVMsZW47cT0wLjknLAogICAgICAgICdBdXRob3JpemF0aW9uJzogJ0Jhc2ljIGJtVnRiMkpzZFdVNlFYQnBWWE5sY2tCSFVFWnAnLAogICAgICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLAogICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgJ09yaWdpbic6ICdodHRwczovL2dwZmkuZ3JhbWVlbnBob25lLmNvbScsCiAgICAgICAgJ1JlZmVyZXInOiAnaHR0cHM6Ly9ncGZpLmdyYW1lZW5waG9uZS5jb20vJywKICAgICAgICAnU2VjLUZldGNoLURlc3QnOiAnZW1wdHknLAogICAgICAgICdTZWMtRmV0Y2gtTW9kZSc6ICdjb3JzJywKICAgICAgICAnU2VjLUZldGNoLVNpdGUnOiAnc2FtZS1zaXRlJywKICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYnLAogICAgICAgICdzZWMtY2gtdWEnOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgJ3NlYy1jaC11YS1tb2JpbGUnOiAnPzEnLAogICAgICAgICdzZWMtY2gtdWEtcGxhdGZvcm0nOiAnIkFuZHJvaWQiJywKICAgIH0KICAgIHBheWxvYWQgPSB7CiAgICAgICAgJ3Bob25lJzogcGhvbmVfbnVtYmVyLAogICAgICAgICdlbWFpbCc6ICcnLAogICAgICAgICdsYW5ndWFnZSc6ICdlbicKICAgIH0KICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249cGF5bG9hZCkKICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiJFcnJvciBkdXJpbmcgR1BGSSBBUEkgY2FsbDoge2V9IikKICAgICAgICByZXR1cm4gTm9uZQoKZGVmIGNhbGxfZ2hvb3JpX2FwaShwaG9uZV9udW1iZXIpOgogICAgcGhvbmUgPSAiKzg4IiArIHBob25lX251bWJlcgogICAgdXJsID0gImh0dHBzOi8vYXBpLmdob29yaWxlYXJuaW5nLmNvbS9hcGkvYXV0aC9zaWdudXAvb3RwP19hcHBfcGxhdGZvcm09d2ViJl9sYW5nPWJuIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiT3JpZ2luIjogImh0dHBzOi8vZ2hvb3JpbGVhcm5pbmcuY29tIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2dob29yaWxlYXJuaW5nLmNvbS8iLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiCiAgICB9CiAgICBkYXRhID0geyJtb2JpbGVfbm8iOiBwaG9uZV9udW1iZXJ9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1kYXRhLCB2ZXJpZnk9RmFsc2UpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2Vhc3lfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9jb3JlLmVhc3kuY29tLmJkL2FwaS92MS9yZWdpc3RyYXRpb24iCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9lYXN5LmNvbS5iZCIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly9lYXN5LmNvbS5iZC8iLAogICAgICAgICJTZWMtRmV0Y2gtRGVzdCI6ICJlbXB0eSIsCiAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLAogICAgICAgICJTZWMtRmV0Y2gtU2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgImRldmljZS1rZXkiOiAiZjNhYTVhY2FmMTdkZTY0ZGI3ZDgyYTAwYzczMTc4YWYiLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicKICAgIH0KICAgIHBheWxvYWQgPSB7CiAgICAgICAgInNvY2lhbF9sb2dpbl9pZCI6ICIiLAogICAgICAgICJuYW1lIjogIlJycnIiLAogICAgICAgICJlbWFpbCI6ICJnb29nbGVAZ21haWwuY29tIiwKICAgICAgICAibW9iaWxlIjogcGhvbmVfbnVtYmVyLAogICAgICAgICJwYXNzd29yZCI6ICIxMjM0NTY3OCIsCiAgICAgICAgInBhc3N3b3JkX2NvbmZpcm1hdGlvbiI6ICIxMjM0NTY3OCIsCiAgICAgICAgImRldmljZV9rZXkiOiAiZjNhYTVhY2FmMTdkZTY0ZGI3ZDgyYTAwYzczMTc4YWYiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9zdW5kYXJiYW5fYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGktZ2F0ZXdheS5zdW5kYXJiYW5jb3VyaWVybHRkLmNvbS9ncmFwaHFsIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImFwaS1nYXRld2F5LnN1bmRhcmJhbmNvdXJpZXJsdGQuY29tIiwKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImF1dGhvcml6YXRpb24iOiAiIiwgICMgTGVmdCBibGFuayBhcyBpbiBjdXJsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vY3VzdG9tZXIuc3VuZGFyYmFuY291cmllcmx0ZC5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vY3VzdG9tZXIuc3VuZGFyYmFuY291cmllcmx0ZC5jb20vIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtc2l0ZSIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQoKICAgIHBheWxvYWQgPSB7CiAgICAgICAgIm9wZXJhdGlvbk5hbWUiOiAiQ3JlYXRlQWNjZXNzVG9rZW4iLAogICAgICAgICJ2YXJpYWJsZXMiOiB7CiAgICAgICAgICAgICJhY2Nlc3NUb2tlbkZpbHRlciI6IHsKICAgICAgICAgICAgICAgICJ1c2VyTmFtZSI6IHBob25lX251bWJlcgogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAicXVlcnkiOiAiIiJtdXRhdGlvbiBDcmVhdGVBY2Nlc3NUb2tlbigkYWNjZXNzVG9rZW5GaWx0ZXI6IEFjY2Vzc1Rva2VuSW5wdXQhKSB7CiAgY3JlYXRlQWNjZXNzVG9rZW4oYWNjZXNzVG9rZW5GaWx0ZXI6ICRhY2Nlc3NUb2tlbkZpbHRlcikgewogICAgbWVzc2FnZQogICAgc3RhdHVzQ29kZQogICAgcmVzdWx0IHsKICAgICAgcGhvbmUKICAgICAgb3RwQ291bnRlcgogICAgICBfX3R5cGVuYW1lCiAgICB9CiAgICBfX3R5cGVuYW1lCiAgfQp9IiIiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9xdWl6Z2lyaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2RldmVsb3Blci5xdWl6Z2lyaS54eXovYXBpL3YyLjAvc2VuZC1vdHAiCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiKi8qIiwKICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiQ29ubmVjdGlvbiI6ICJrZWVwLWFsaXZlIiwKICAgICAgICAiQ29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9hcHAucXVpemdpcmkuY29tLmJkIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL2FwcC5xdWl6Z2lyaS5jb20uYmQvIiwKICAgICAgICAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLAogICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJjb3JzIiwKICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAiY3Jvc3Mtc2l0ZSIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAiWC1SZXF1ZXN0ZWQtV2l0aCI6ICJYTUxIdHRwUmVxdWVzdCIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJ4LWFwaS1rZXkiOiAiZ1lzaU5TVkJEdUN0OHlNVVhwRjA2aVExZURyTUd2NkciCiAgICB9CgogICAgcGF5bG9hZCA9IHsKICAgICAgICAicGhvbmUiOiBwaG9uZV9udW1iZXIsCiAgICAgICAgImNvdW50cnlfY29kZSI6ICIrODgiLAogICAgICAgICJmY21fdG9rZW4iOiBOb25lCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1wYXlsb2FkKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3JvbW9uaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9IGYiaHR0cHM6Ly9yb21vbmkuY29tLmJkL2FwaS9zZW5kLW90cD9waG9uZT17cGhvbmVfbnVtYmVyfSIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImF1dGhvcml0eSI6ICJyb21vbmkuY29tLmJkIiwKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjkiLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9yb21vbmkuY29tLmJkL3NpZ251cCIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAjIENvb2tpZSBub3QgcmVxdWlyZWQgdW5sZXNzIHlvdSB3YW50IHRvIHNpbXVsYXRlIGEgbG9nZ2VkLWluIHNlc3Npb24KICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpICAKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5SZXF1ZXN0RXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9iZHRpY2tldHNfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuYmR0aWNrZXRzLmNvbToyMDEwMC92MS9hdXRoIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYXV0aG9yaXR5IjogImFwaS5iZHRpY2tldHMuY29tOjIwMTAwIiwKICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vYmR0aWNrZXRzLmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly9iZHRpY2tldHMuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBwYXlsb2FkID0gewogICAgICAgICJjcmVhdGVVc2VyQ2hlY2siOiBUcnVlLAogICAgICAgICJwaG9uZU51bWJlciI6IGYiKzg4e3Bob25lX251bWJlci5sc3RyaXAoJysnKX0iLAogICAgICAgICJhcHBsaWNhdGlvbkNoYW5uZWwiOiAiV0VCX0FQUCIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPXBheWxvYWQpIAogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb24gYXMgZToKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2dwZmkxX2FwaShwaG9uZV9udW1iZXI9Tm9uZSk6CiAgICBpZiBwaG9uZV9udW1iZXIgaXMgTm9uZToKICAgICAgICBwaG9uZV9udW1iZXIgPSBpbnB1dCgiRW50ZXIgcGhvbmUgbnVtYmVyIGZvciBHUEZJIEFQSTogIikuc3RyaXAoKQoKICAgIHVybCA9ICJodHRwczovL3dlYmxvZ2luZGEuZ3JhbWVlbnBob25lLmNvbS9iYWNrZW5kL2FwaS92MS9vdHAiCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly93d3cuZ3JhbWVlbnBob25lLmNvbSIsCiAgICAgICAgIlJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuZ3JhbWVlbnBob25lLmNvbS8iLAogICAgICAgICJTZWMtRmV0Y2gtRGVzdCI6ICJlbXB0eSIsCiAgICAgICAgIlNlYy1GZXRjaC1Nb2RlIjogImNvcnMiLAogICAgICAgICJTZWMtRmV0Y2gtU2l0ZSI6ICJzYW1lLXNpdGUiLAogICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgfQoKICAgIHBheWxvYWQgPSB7CiAgICAgICAgIm1zaXNkbiI6IHBob25lX251bWJlcgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9cGF5bG9hZCkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQ6CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9hcm9nZ2FfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuYXJvZ2dhLmNvbS9hdXRoL3YxL3Ntcy9zZW5kP2Y9bXdlYiZiPSZ2PSZvcz0mb3N2PSZyZWZQYXJ0bmVyPSIKCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiKi8qIiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PVVURi04IiwKICAgICAgICAib3JpZ2luIjogImh0dHBzOi8vbS5hcm9nZ2EuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL20uYXJvZ2dhLmNvbS8iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBkYXRhID0gewogICAgICAgICJtb2JpbGUiOiBmIis4OHtwaG9uZV9udW1iZXJ9IiwKICAgICAgICAiZmNtVG9rZW4iOiAiIiwKICAgICAgICAicmVmZXJyYWwiOiAiIgogICAgfQoKICAgIHRyeToKICAgICAgICByZXMgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWRhdGEsIHRpbWVvdXQ9MTApCiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9tZWRlYXN5X2FwaShwaG9uZV9udW1iZXIpOgogICAgcGhvbmUgPSAiKzg4IiArIHBob25lX251bWJlcgogICAgdXJsID0gZiJodHRwczovL2FwaS5tZWRlYXN5LmhlYWx0aC9hcGkvc2VuZC1vdHAve3Bob25lfS8iCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgIk9yaWdpbiI6ICJodHRwczovL21lZGVhc3kuaGVhbHRoIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL21lZGVhc3kuaGVhbHRoLyIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAiU2VjLUZldGNoLURlc3QiOiAiZW1wdHkiLAogICAgICAgICJTZWMtRmV0Y2gtTW9kZSI6ICJjb3JzIiwKICAgICAgICAiU2VjLUZldGNoLVNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9vc3VkcG90cm9fYXBpKHBob25lX251bWJlcik6CiAgICBwaG9uZSA9ICIrODgtIiArIHBob25lX251bWJlcgogICAgdXJsID0gImh0dHBzOi8vYXBpLm9zdWRwb3Ryby5jb20vYXBpL3YxL3VzZXJzL3NlbmRfb3RwIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKiIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9vc3VkcG90cm8uY29tIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL29zdWRwb3Ryby5jb20vIiwKICAgICAgICAiVXNlci1BZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIgogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAibW9iaWxlIjogcGhvbmUsCiAgICAgICAgImRldmljZVRva2VuIjogIndlYiIsCiAgICAgICAgImxhbmd1YWdlIjogImVuIiwKICAgICAgICAib3MiOiAid2ViIgogICAgfQoKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfYXJvZ2dhX2FwaShwaG9uZV9udW1iZXIpOgogICAgcGhvbmUgPSAiJTJCODgiICsgcGhvbmVfbnVtYmVyCiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuYXJvZ2dhLmNvbS9hdXRoL3YxL3Ntcy9zZW5kP2Y9bXdlYiZiPSZ2PSZvcz0mb3N2PSZyZWZQYXJ0bmVyPSIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkFjY2VwdCI6ICIqLyoiLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkO2NoYXJzZXQ9VVRGLTgiLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9tLmFyb2dnYS5jb20iLAogICAgICAgICJSZWZlcmVyIjogImh0dHBzOi8vbS5hcm9nZ2EuY29tLyIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtc2l0ZSIKICAgIH0KICAgIGRhdGEgPSBmIm1vYmlsZT17cGhvbmV9JmZjbVRva2VuPSZyZWZlcnJhbD0iCgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9tZWRlYXN5X2FwaShwaG9uZV9udW1iZXIpOgogICAgcGhvbmUgPSAiKzg4IiArIHBob25lX251bWJlcgogICAgdXJsID0gZiJodHRwczovL2FwaS5tZWRlYXN5LmhlYWx0aC9hcGkvc2VuZC1vdHAve3Bob25lfS8iCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIkFjY2VwdC1MYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgIkNvbm5lY3Rpb24iOiAia2VlcC1hbGl2ZSIsCiAgICAgICAgIk9yaWdpbiI6ICJodHRwczovL21lZGVhc3kuaGVhbHRoIiwKICAgICAgICAiUmVmZXJlciI6ICJodHRwczovL21lZGVhc3kuaGVhbHRoLyIsCiAgICAgICAgIlNlYy1GZXRjaC1EZXN0IjogImVtcHR5IiwKICAgICAgICAiU2VjLUZldGNoLU1vZGUiOiAiY29ycyIsCiAgICAgICAgIlNlYy1GZXRjaC1TaXRlIjogInNhbWUtc2l0ZSIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3VsYV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2Vwb3J0YWwudWxhLmNvbS5iZC9hcGkvc2VuZC1vdHAtdG8tcGhvbmUiCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiKi8qIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45IiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly93d3cudWxhLmNvbS5iZCIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly93d3cudWxhLmNvbS5iZC8iLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1zaXRlIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CiAgICBkYXRhID0gewogICAgICAgICJwaG9uZV9udW1iZXIiOiAiKzg4IiArIHBob25lX251bWJlciwKICAgICAgICAiZnJvbSI6ICJjdXN0b21lciIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWRhdGEpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX2xhenpwaGFybWFfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAiaHR0cHM6Ly93d3cubGF6enBoYXJtYS5jb20vTWVzc2FnaW5nQXJlYS9PdHBNZXNzYWdlL1dlYlJlZ2lzdGVyIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImFjY2Vzcy1jb250cm9sLWFsbG93LW9yaWdpbiI6ICIqIiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly93d3cubGF6enBoYXJtYS5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vd3d3LmxhenpwaGFybWEuY29tLyIsCiAgICAgICAgInNlYy1jaC11YSI6ICciQ2hyb21pdW0iO3Y9IjEzNyIsICJOb3QvQSlCcmFuZCI7dj0iMjQiJywKICAgICAgICAic2VjLWNoLXVhLW1vYmlsZSI6ICI/MSIsCiAgICAgICAgInNlYy1jaC11YS1wbGF0Zm9ybSI6ICciQW5kcm9pZCInLAogICAgICAgICJzZWMtZmV0Y2gtZGVzdCI6ICJlbXB0eSIsCiAgICAgICAgInNlYy1mZXRjaC1tb2RlIjogImNvcnMiLAogICAgICAgICJzZWMtZmV0Y2gtc2l0ZSI6ICJzYW1lLW9yaWdpbiIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQogICAgZGF0YSA9IHsKICAgICAgICAiQWN0aXZpdHlJZCI6ICIxODM0Yjg5Ny00ODg0LTQ2MzAtYTkwOS1iMWYwNTRhYzEwZWQiLAogICAgICAgICJQaG9uZSI6ICIrODgiICsgcGhvbmVfbnVtYmVyCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywganNvbj1kYXRhKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9yb2tvbWFyaV9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9IGYiaHR0cHM6Ly93d3cucm9rb21hcmkuY29tL290cC9zZW5kP2VtYWlsT3JQaG9uZT04OHtwaG9uZV9udW1iZXJ9JmNvdW50cnlDb2RlPUJEIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiYWNjZXB0IjogIiovKiIsCiAgICAgICAgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1VUyxlbjtxPTAuOSIsCiAgICAgICAgImNvbnRlbnQtbGVuZ3RoIjogIjAiLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly93d3cucm9rb21hcmkuY29tIiwKICAgICAgICAicmVmZXJlciI6ICJodHRwczovL3d3dy5yb2tvbWFyaS5jb20vbG9naW4iLAogICAgICAgICJzZWMtY2gtdWEiOiAnIkNocm9taXVtIjt2PSIxMzciLCAiTm90L0EpQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgInNlYy1jaC11YS1tb2JpbGUiOiAiPzEiLAogICAgICAgICJzZWMtY2gtdWEtcGxhdGZvcm0iOiAnIkFuZHJvaWQiJywKICAgICAgICAic2VjLWZldGNoLWRlc3QiOiAiZW1wdHkiLAogICAgICAgICJzZWMtZmV0Y2gtbW9kZSI6ICJjb3JzIiwKICAgICAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1vcmlnaW4iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgIngtcmVxdWVzdGVkLXdpdGgiOiAiWE1MSHR0cFJlcXVlc3QiCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycykKICAgICAgICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfc21hcnRwb3N0YmRfYXBpKHBob25lX251bWJlcik6CiAgICB1cmwgPSAnaHR0cHM6Ly9hcGkuc21hcnRwb3N0YmQuY29tL29ubGluZS1ib29raW5nL2FwaS9yZWdpc3Rlci1vdHAnCiAgICBoZWFkZXJzID0gewogICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJywKICAgICAgICAnQWNjZXB0LUxhbmd1YWdlJzogJ2VuLVVTLGVuO3E9MC45JywKICAgICAgICAnQ29ubmVjdGlvbic6ICdrZWVwLWFsaXZlJywKICAgICAgICAnQ29udGVudC1UeXBlJzogJ211bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PS0tLS1XZWJLaXRGb3JtQm91bmRhcnlzR2dxNTJicHRIZ0t0NVNlJywKICAgICAgICAnT3JpZ2luJzogJ2h0dHBzOi8vb25saW5lLmJwb2Rtcy5nb3YuYmQnLAogICAgICAgICdSZWZlcmVyJzogJ2h0dHBzOi8vb25saW5lLmJwb2Rtcy5nb3YuYmQvJywKICAgICAgICAnU2VjLUZldGNoLURlc3QnOiAnZW1wdHknLAogICAgICAgICdTZWMtRmV0Y2gtTW9kZSc6ICdjb3JzJywKICAgICAgICAnU2VjLUZldGNoLVNpdGUnOiAnY3Jvc3Mtc2l0ZScsCiAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKICAgICAgICAnc2VjLWNoLXVhJzogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICdzZWMtY2gtdWEtbW9iaWxlJzogJz8xJywKICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtJzogJyJBbmRyb2lkIicsCiAgICB9CiAgICBkYXRhID0gKAogICAgICAgICctLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlzR2dxNTJicHRIZ0t0NVNlXHJcbicKICAgICAgICAnQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJwaG9uZSJcclxuXHJcbicKICAgICAgICBmJ3twaG9uZV9udW1iZXJ9XHJcbicKICAgICAgICAnLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5c0dncTUyYnB0SGdLdDVTZVxyXG4nCiAgICAgICAgJ0NvbnRlbnQtRGlzcG9zaXRpb246IGZvcm0tZGF0YTsgbmFtZT0icGFzc3dvcmQiXHJcblxyXG4nCiAgICAgICAgJ0ExMjM0NTY3OGFcclxuJwogICAgICAgICctLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlzR2dxNTJicHRIZ0t0NVNlXHJcbicKICAgICAgICAnQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPSJyZXBhc3N3b3JkIlxyXG5cclxuJwogICAgICAgICdBMTIzNDU2NzhhXHJcbicKICAgICAgICAnLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5c0dncTUyYnB0SGdLdDVTZS0tXHJcbicKICAgICkKICAgIHRyeToKICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9ZGF0YSwgdmVyaWZ5PUZhbHNlKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIEZhbHNlCgpkZWYgY2FsbF9kaWdpaGFhdF9hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS5kaWdpaGFhdC5jb20uYmQvYXBpL290cC9nZW5lcmF0ZS1vdHAiCiAgICBoZWFkZXJzID0gewogICAgICAgICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAiQWNjZXB0LUxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJPcmlnaW4iOiAiaHR0cHM6Ly9kaWdpaGFhdC5jb20uYmQiLAogICAgICAgICJSZWZlcmVyIjogImh0dHBzOi8vZGlnaWhhYXQuY29tLmJkLyIsCiAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IiwKICAgIH0KICAgIGRhdGEgPSB7InBob25lTm8iOiBwaG9uZV9udW1iZXJ9CiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBqc29uPWRhdGEpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMQogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3dhbHRvbnBsYXphX2FwaShwaG9uZV9udW1iZXIpOgogICAgdXJsID0gImh0dHBzOi8vd2FsdG9ucGxhemEuY29tLmJkL2FwaS9hdXRoL290cC9jcmVhdGUiCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiKi8qIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly93YWx0b25wbGF6YS5jb20uYmQiLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vd2FsdG9ucGxhemEuY29tLmJkL2F1dGgvcGhvbmUtbG9naW4iLAogICAgICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgSykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEzNy4wLjAuMCBNb2JpbGUgU2FmYXJpLzUzNy4zNiIKICAgIH0KCiAgICBkYXRhID0gewogICAgICAgICJhdXRoIjogewogICAgICAgICAgICAiY291bnRyeUNvZGUiOiAiODgwIiwKICAgICAgICAgICAgImRldmljZVV1aWQiOiAiN2Y1NDY0ODAtMzJkNy0xMWYwLThiYTktMjdkOTBjYTdiZDQ4IiwKICAgICAgICAgICAgInBob25lIjogcGhvbmVfbnVtYmVyLmxzdHJpcCgiKzg4IiksCiAgICAgICAgICAgICJ0eXBlIjogIkxPR0lOIgogICAgICAgIH0sCiAgICAgICAgImNhcHRjaGFUb2tlbiI6ICJubyByZWNhcGNoYSIKICAgIH0KCiAgICB0cnk6CiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwganNvbj1kYXRhLCBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMAogICAgZXhjZXB0OgogICAgICAgIHJldHVybiBGYWxzZQoKZGVmIGNhbGxfc2h3YXBub19hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL3d3dy5zaHdhcG5vLmNvbS9hcGkvYXV0aCIKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImFjY2VwdCI6ICIqLyoiLAogICAgICAgICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tVVMsZW47cT0wLjksYm4tQkQ7cT0wLjgsYm47cT0wLjciLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgIm9yaWdpbiI6ICJodHRwczovL3d3dy5zaHdhcG5vLmNvbSIsCiAgICAgICAgInJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuc2h3YXBuby5jb20vIiwKICAgICAgICAic2VjLWNoLXVhIjogJyJDaHJvbWl1bSI7dj0iMTM3IiwgIk5vdC9BKUJyYW5kIjt2PSIyNCInLAogICAgICAgICJzZWMtY2gtdWEtbW9iaWxlIjogIj8xIiwKICAgICAgICAic2VjLWNoLXVhLXBsYXRmb3JtIjogJyJBbmRyb2lkIicsCiAgICAgICAgInNlYy1mZXRjaC1kZXN0IjogImVtcHR5IiwKICAgICAgICAic2VjLWZldGNoLW1vZGUiOiAiY29ycyIsCiAgICAgICAgInNlYy1mZXRjaC1zaXRlIjogInNhbWUtb3JpZ2luIiwKICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgMTA7IEspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMzcuMC4wLjAgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICB9CgogICAgZGF0YSA9IHsKICAgICAgICAicGhvbmVOdW1iZXIiOiBwaG9uZV9udW1iZXIgICMgZnVsbCBudW1iZXIgbXVzdCBiZSBwYXNzZWQgY29ycmVjdGx5CiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBjYWxsX3NoaWtob19hcGkocGhvbmVfbnVtYmVyKToKICAgIHVybCA9ICJodHRwczovL2FwaS5zaGlraG8uY29tL2F1dGgvdjIvc2VuZC9zbXMiCiAgICBoZWFkZXJzID0gewogICAgICAgICJhY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qIiwKICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImVuLVVTLGVuO3E9MC45LGJuLUJEO3E9MC44LGJuO3E9MC43IiwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJvcmlnaW4iOiAiaHR0cHM6Ly9zaG9wLnNoaWtoby5jb20iLAogICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vc2hvcC5zaGlraG8uY29tLyIsCiAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBLKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTM3LjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2IgogICAgfQoKICAgIGRhdGEgPSB7CiAgICAgICAgInBob25lIjogcGhvbmVfbnVtYmVyLCAgIyBtdXN0IGluY2x1ZGUgODgwIHByZWZpeCBpZiBuZWVkZWQKICAgICAgICAidHlwZSI6ICJzdHVkZW50IiwKICAgICAgICAiYXV0aF90eXBlIjogInNpZ251cCIsCiAgICAgICAgInZlbmRvciI6ICJzaGlraG8iCiAgICB9CgogICAgdHJ5OgogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdCh1cmwsIGpzb249ZGF0YSwgaGVhZGVycz1oZWFkZXJzKQogICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgIGV4Y2VwdDoKICAgICAgICByZXR1cm4gRmFsc2UKIyA9PT09PT09PT09PT09PT09PT09PT0gQVBJIEhBTkRMRVIgPT09PT09PT09PT09PT09PT09PT09CmRlZiBoYW5kbGVfYXBpcyhtb2JpbGVfbnVtYmVyKToKICAgIGN1cnJlbnRfbW9kdWxlID0gc3lzLm1vZHVsZXNbX19uYW1lX19dCiAgICBhcGlfZnVuY3Rpb25zID0gWwogICAgICAgIChuYW1lLCBmdW5jKSBmb3IgbmFtZSwgZnVuYyBpbiBpbnNwZWN0LmdldG1lbWJlcnMoY3VycmVudF9tb2R1bGUsIGluc3BlY3QuaXNmdW5jdGlvbikKICAgICAgICBpZiBuYW1lLnN0YXJ0c3dpdGgoImNhbGxfIikgYW5kIG5hbWUuZW5kc3dpdGgoIl9hcGkiKQogICAgXQoKICAgIHN1Y2Nlc3NfYXBpcyA9IFtdCiAgICBmYWlsZWRfYXBpcyA9IFtdCgogICAgZm9yIG5hbWUsIGFwaV9mdW5jIGluIGFwaV9mdW5jdGlvbnM6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBpZiBhcGlfZnVuYyhtb2JpbGVfbnVtYmVyKToKICAgICAgICAgICAgICAgIHN1Y2Nlc3NfYXBpcy5hcHBlbmQobmFtZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGZhaWxlZF9hcGlzLmFwcGVuZChuYW1lKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIGZhaWxlZF9hcGlzLmFwcGVuZChuYW1lKQoKICAgIHJldHVybiBzdWNjZXNzX2FwaXMsIGZhaWxlZF9hcGlzCgojID09PT09PT09PT09PT09PT09PT09PSBNQUlOID09PT09PT09PT09PT09PT09PT09PQpkZWYgbWFpbigpOgogICAgYW5pbWF0ZV9iYW5uZXIoKQogICAgcHJpbnQoRm9yZS5DWUFOICsgU3R5bGUuQlJJR0hUICsgIlxuV2VsY29tZSB0byB0aGUgU01TIPCfkqVCb29tZXLwn5KlIFRvb2whXG4iKQogICAgbW9iaWxlX251bWJlciA9IGlucHV0KEZvcmUuUkVEICsgU3R5bGUuQlJJR0hUICsgIkVudGVyIHRoZSBtb2JpbGUgbnVtYmVyIChFeC4gMDE3MzQ1Njc4OTApOiAiKS5zdHJpcCgpCgogICAgcHJpbnQoKQoKICAgIGlmIG5vdCAobW9iaWxlX251bWJlci5zdGFydHN3aXRoKCIwMSIpIGFuZCBsZW4obW9iaWxlX251bWJlcikgPT0gMTEpOgogICAgICAgIHByaW50KEZvcmUuUkVEICsgIkludmFsaWQgbnVtYmVyLiBNdXN0IHN0YXJ0IHdpdGggMDEgYW5kIGJlIDExIGRpZ2l0cy4iKQogICAgICAgIHJldHVybgoKICAgIHRyeToKICAgICAgICBtZXNzYWdlX2dvYWwgPSBpbnQoaW5wdXQoRm9yZS5ZRUxMT1cgKyBTdHlsZS5CUklHSFQgKyAiSG93IG1hbnkgbWVzc2FnZXMgZG8geW91IHdhbnQgdG8gc2VuZD8gIDogIikpCiAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICBwcmludChGb3JlLlJFRCArICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBudW1iZXIuIikKICAgICAgICByZXR1cm4KCiAgICBjdXJyZW50X21vZHVsZSA9IHN5cy5tb2R1bGVzW19fbmFtZV9fXQogICAgYXBpX2Z1bmN0aW9ucyA9IFsKICAgICAgICBmdW5jIGZvciBuYW1lLCBmdW5jIGluIGluc3BlY3QuZ2V0bWVtYmVycyhjdXJyZW50X21vZHVsZSwgaW5zcGVjdC5pc2Z1bmN0aW9uKQogICAgICAgIGlmIG5hbWUuc3RhcnRzd2l0aCgiY2FsbF8iKSBhbmQgbmFtZS5lbmRzd2l0aCgiX2FwaSIpCiAgICBdCgogICAgbWF4X2F2YWlsYWJsZSA9IGxlbihhcGlfZnVuY3Rpb25zKQogICAgcHJpbnQoRm9yZS5NQUdFTlRBICsgIlxuU2VuZGluZyBTTVMuLi5cbiIuY2VudGVyKHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSgpLmNvbHVtbnMpKQoKICAgIHRvdGFsX3N1Y2Nlc3MgPSBbXQogICAgdG90YWxfZmFpbGVkID0gW10KICAgIHNlbnRfY291bnQgPSAwICAjIENvdW50IHN1Y2Nlc3NmdWwgc2VuZHMKCiAgICBpZiBtZXNzYWdlX2dvYWwgPj0gbWF4X2F2YWlsYWJsZToKICAgICAgICBmb3IgYXBpX2Z1bmMgaW4gYXBpX2Z1bmN0aW9uczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgYXBpX2Z1bmMobW9iaWxlX251bWJlcik6CiAgICAgICAgICAgICAgICAgICAgdG90YWxfc3VjY2Vzcy5hcHBlbmQoYXBpX2Z1bmMuX19uYW1lX18pCiAgICAgICAgICAgICAgICAgICAgc2VudF9jb3VudCArPSAxCiAgICAgICAgICAgICAgICAgICAgdGVybV93aWR0aCA9IHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSgpLmNvbHVtbnMKICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgU3R5bGUuQlJJR0hUICsgZiJccnsnU01TIHNlbnQgPSAnICsgc3RyKHNlbnRfY291bnQpOl57dGVybV93aWR0aH19IiwgZW5kPScnLCBmbHVzaD1UcnVlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0b3RhbF9mYWlsZWQuYXBwZW5kKGFwaV9mdW5jLl9fbmFtZV9fKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjMpICAjIGRlbGF5CiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgICAgICB0b3RhbF9mYWlsZWQuYXBwZW5kKGFwaV9mdW5jLl9fbmFtZV9fKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjMpCiAgICBlbHNlOgogICAgICAgIHN1Y2Nlc3NfY291bnQgPSAwCiAgICAgICAgd2hpbGUgc3VjY2Vzc19jb3VudCA8IG1lc3NhZ2VfZ29hbDoKICAgICAgICAgICAgZm9yIGFwaV9mdW5jIGluIGFwaV9mdW5jdGlvbnM6CiAgICAgICAgICAgICAgICBpZiBzdWNjZXNzX2NvdW50ID49IG1lc3NhZ2VfZ29hbDoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGlmIGFwaV9mdW5jKG1vYmlsZV9udW1iZXIpOgogICAgICAgICAgICAgICAgICAgICAgICB0b3RhbF9zdWNjZXNzLmFwcGVuZChhcGlfZnVuYy5fX25hbWVfXykKICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc19jb3VudCArPSAxCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbnRfY291bnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICB0ZXJtX3dpZHRoID0gc2h1dGlsLmdldF90ZXJtaW5hbF9zaXplKCkuY29sdW1ucwogICAgICAgICAgICAgICAgICAgICAgICBwcmludChGb3JlLkdSRUVOICsgU3R5bGUuQlJJR0hUICsgZiJccnsnU01TIHNlbnQgPSAnICsgc3RyKHNlbnRfY291bnQpOl57dGVybV93aWR0aH19IiwgZW5kPScnLCBmbHVzaD1UcnVlKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsX2ZhaWxlZC5hcHBlbmQoYXBpX2Z1bmMuX19uYW1lX18pCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjMpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICAgICAgICAgIHRvdGFsX2ZhaWxlZC5hcHBlbmQoYXBpX2Z1bmMuX19uYW1lX18pCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjMpCgogICAgcHJpbnQoIlxuIikKICAgIHByaW50KEZvcmUuQ1lBTiArICJcblN1bW1hcnk6XG4iLmNlbnRlcihzaHV0aWwuZ2V0X3Rlcm1pbmFsX3NpemUoKS5jb2x1bW5zKSkKICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIuKclCBUb3RhbCBTdWNjZXNzZnVsOiB7bGVuKHRvdGFsX3N1Y2Nlc3MpfSIuY2VudGVyKHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSgpLmNvbHVtbnMpKQogICAgcHJpbnQoRm9yZS5SRUQgKyBmIlxu4pyYIFRvdGFsIEZhaWxlZCBBdHRlbXB0czoge2xlbih0b3RhbF9mYWlsZWQpfSIuY2VudGVyKHNodXRpbC5nZXRfdGVybWluYWxfc2l6ZSgpLmNvbHVtbnMpKQogICAgaWYgdG90YWxfZmFpbGVkOgogICAgICAgIGZvciBhcGkgaW4gdG90YWxfZmFpbGVkOgogICAgICAgICAgICBwcmludChGb3JlLlJFRCArIGYiICDihpIge2FwaX0iKQoKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBtYWluKCk='))